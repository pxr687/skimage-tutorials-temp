
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>What about colour? &#8212; Scikit-image via NumPy and SciPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1_colour_images_as_numpy_arrays';</script>
    <link rel="canonical" href="https://pxr687.github.io/skimage-tutorials-temp/1_colour_images_as_numpy_arrays.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introducing Scikit-image" href="2_skimage_intro.html" />
    <link rel="prev" title="What is an image? - Images as NumPy arrays" href="0_images_as_numpy_arrays.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/colourwheel.png" class="logo__image only-light" alt="Scikit-image via NumPy and SciPy - Home"/>
    <script>document.write(`<img src="_static/colourwheel.png" class="logo__image only-dark" alt="Scikit-image via NumPy and SciPy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Scikit-image via NumPy and SciPy</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_images_as_numpy_arrays.html">What is an image? - Images as NumPy arrays</a></li>







<li class="toctree-l1 current active"><a class="current reference internal" href="#">What about colour?</a></li>





<li class="toctree-l1"><a class="reference internal" href="2_skimage_intro.html">Introducing Scikit-image</a></li>










<li class="toctree-l1"><a class="reference internal" href="3_skimage_processing_from_numpy_and_scipy.html">(Sci-kit) Image processing, via NumPy and SciPy</a></li>













<li class="toctree-l1"><a class="reference internal" href="4_threshold_filters.html">Threshold filtering</a></li>






<li class="toctree-l1"><a class="reference internal" href="5_mean_filter.html">Convolutional filtering I - the mean filter</a></li>





<li class="toctree-l1"><a class="reference internal" href="6_gaussian_sharpening_edge.html">Convolutional filtering II - Gaussian blur, sharpening and edge detection</a></li>








<li class="toctree-l1"><a class="reference internal" href="8_morphology.html">Morphology</a></li>







</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/edit/main/1_colour_images_as_numpy_arrays.Rmd" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/issues/new?title=Issue%20on%20page%20%2F1_colour_images_as_numpy_arrays.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/1_colour_images_as_numpy_arrays.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>What about colour?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">What about colour?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#true-colour-in-3d">True Colour in 3D</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colour-channels">Colour channels</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pixels-and-dtype">Pixels and <code class="docutils literal notranslate"><span class="pre">dtype</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-actually-complex-images">More (actually) complex images</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="what-about-colour">
<h1>What about colour?<a class="headerlink" href="#what-about-colour" title="Link to this heading">#</a></h1>
<p>All of the arrays we have encountered <a class="reference internal" href="0_images_as_numpy_arrays.html"><span class="doc std std-doc">so far</span></a> contain just one value at each array pixel location. This page will look at image arrays with more complex shapes, and show how this can encode colour information, giving us beautiful colour images, that create deep aesthetic experiences, like this one:</p>
<p><img alt="" src="_images/xenomorph.png" />
(Image from <a class="reference external" href="https://static1.srcdn.com/wordpress/wp-content/uploads/2019/07/Xenomorph-from-the-Alien-franchise.jpg">here</a>).</p>
<p>First, some library imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Library imports.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Set &#39;gray&#39; as the default colormap.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span>

<span class="c1"># Import a custom function to give hints for some exercises.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hints</span><span class="w"> </span><span class="kn">import</span> <span class="n">hint_corrupted_camera</span>
</pre></div>
</div>
</div>
</div>
<p>Below, we create some low-resolution 2-D image arrays, with which to explore colour representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A two-dimensional numpy array of 1&#39;s and 0&#39;s.</span>
<span class="n">two_D_ones_and_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span> 
                                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,]],</span>
                                 <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># A two dimensional numpy array of numbers between 0 and 10.</span>
<span class="n">two_D_other_integers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> 
                                 <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>
                                 <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Another image array.</span>
<span class="n">smiley</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                 <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In our humble <code class="docutils literal notranslate"><span class="pre">two_D_ones_and_zeros</span></code> image array, each pixel is either a 1 or 0 in the <code class="docutils literal notranslate"><span class="pre">float64</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array, via NumPy, then plot.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">two_D_ones_and_zeros</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_ones_and_zeros</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0.]
 [0. 1.]]
</pre></div>
</div>
<img alt="_images/2a1270b76ee63901c527e81d9b4211ae5ed3caa9038976f28db9e32adb6fa147.png" src="_images/2a1270b76ee63901c527e81d9b4211ae5ed3caa9038976f28db9e32adb6fa147.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_D_ones_and_zeros</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<p>Conversely, the array <code class="docutils literal notranslate"><span class="pre">two_D_other_integers</span></code> contains different integer values. Note that, though these <em>numbers</em> themselves are integers, they are represented by NumPy as <code class="docutils literal notranslate"><span class="pre">float64</span></code> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Another image from earlier.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">two_D_other_integers</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_other_integers</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0. 10.]
 [ 5.  3.]]
</pre></div>
</div>
<img alt="_images/ced8e7f6daddd64bd28552ce0df64e911b4306f8dcc45bc5c023a0882e9745f1.png" src="_images/ced8e7f6daddd64bd28552ce0df64e911b4306f8dcc45bc5c023a0882e9745f1.png" />
</div>
</div>
<p>The first image - with black and white squares only, no grey - is a <em>binary image</em>. This is an image where each array pixel contains only one of two values. In this case the two values are 0 or 1, with 0 corresponding to black pixels and 1 corresponding to white pixels.</p>
<p>The second image - black, white and grey squares - is a <em>monochrome image</em>. This image contains more than two unique values. It has black pixels (the lowest pixel values, 0); white pixels (the highest pixel values, 1); and grey pixels (intermediate pixel values, &gt; 0 but &lt; 1).</p>
<p><strong>This is important:</strong> for two-dimensional arrays like these each array pixel is just a <em>single number</em>. Because of this, we can refer to both of these arrays as <em>single-channel image arrays</em>. Each individual array pixel value determines the <em>intensity</em> of that pixel, e.g. the brightness or darkness of that pixel.</p>
<p>As we saw on the <a class="reference internal" href="0_images_as_numpy_arrays.html"><span class="doc std std-doc">last page</span></a>, a colourmap (e.g. <code class="docutils literal notranslate"><span class="pre">viridis</span></code> or <code class="docutils literal notranslate"><span class="pre">gray</span></code>) maps  each single-valued pixel intensity to a gradient of colours/shades. This is a black-grey-white gradient for the <code class="docutils literal notranslate"><span class="pre">gray</span></code> colourmap and a purple-yellow gradient for the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> colourmap. Technically speaking, for single-channel image arrays, the intensity values only convey black-white-gray information - the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> colourmap merely <em>translates</em> this black-grey-white information into a coloured presentation for the purposes of display.</p>
<p>What <code class="docutils literal notranslate"><span class="pre">viridis</span></code> is doing is called <a class="reference external" href="https://www.spiedigitallibrary.org/conference-proceedings-of-spie/0048/0000/Digital-Image-Processing-With-Pseudo-Color/10.1117/12.954071.short"><em>pseudo-colouring</em></a> - it is mapping black-grey-white information to display colours. The plot below show’s both arrays, with both colourmaps, for comparison:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># An image from earlier (using the `grey` colourmap)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_ones_and_zeros</span><span class="p">,</span>
            <span class="n">fignum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;`gray` colourmap </span><span class="se">\n</span><span class="s1">(binary image)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># Another image from earlier (using the `grey` colourmap)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_other_integers</span><span class="p">,</span>
            <span class="n">fignum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;`gray` colourmap </span><span class="se">\n</span><span class="s1">(monochrome image)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>

<span class="c1"># Show with pseudocolour using the `viridis` colourmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_ones_and_zeros</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
            <span class="n">fignum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;`viridis` colourmap </span><span class="se">\n</span><span class="s1">(binary image)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_other_integers</span><span class="p">,</span> 
            <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
            <span class="n">fignum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;`viridis` colourmap </span><span class="se">\n</span><span class="s1">(monochrome image)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eccd2e73cd9b17fb4065b6f615c36487cdd60b9ce7529f4452854deb501c9511.png" src="_images/eccd2e73cd9b17fb4065b6f615c36487cdd60b9ce7529f4452854deb501c9511.png" />
</div>
</div>
<p>We can say then, that the plots on the bottom row are <em>displayed using pseudo-colour</em>. The original image arrays only contain black-white-grey information in their pixel intensity values; they do not contain <em>true colour</em> information. <strong>This will be true of any two-dimensional image array</strong>, and both of these image arrays are two-dimensional:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the dimensionality of our binary image array.</span>
<span class="n">two_D_ones_and_zeros</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the dimensionality of our greyscale image array.</span>
<span class="n">two_D_other_integers</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2)
</pre></div>
</div>
</div>
</div>
<p>An image which has what we will call <em>true colour</em> contains information in each array pixel about more than just <em>intensity</em> - it also contains information about <em>colour</em>. So, to hammer this point home: greyscale and binary images displayed with the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> colourmap do not contain true colour information in their array pixel values. Instead Matplotlib is <em>displaying</em> binary and greyscale information using colours. To introduce true colour into the image, we need a spooky third dimension…</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="true-colour-in-3d">
<h1>True Colour in 3D<a class="headerlink" href="#true-colour-in-3d" title="Link to this heading">#</a></h1>
<p>Sounds Sci-Fi! But what does it mean?</p>
<p>Let’s focus on our lowly 4-pixel binary array (4 <em>array pixels</em>, that is):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array.</span>
<span class="n">two_D_ones_and_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Let’s visualise this array with Matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Our 4-pixel, binary array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">two_D_ones_and_zeros</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a552b69d410cf7c4942dcfc6cdee2f83086e428722358481187b8cbee2d983d.png" src="_images/1a552b69d410cf7c4942dcfc6cdee2f83086e428722358481187b8cbee2d983d.png" />
</div>
</div>
<p>Now, picture this array as physical object, like a tray, standing on one side, in physical space:</p>
<p><img alt="" src="_images/one_slice.png" /></p>
<p>Now, imagine “stacking” multiple copies of this array, and standing them in front of each other, like this:</p>
<p><img alt="" src="_images/two_slice.png" /></p>
<p>Let’s refer to each of these objects as a <em>slice</em>. So we have two slices in the image above, one in the foreground, and one in the background.</p>
<p>We can do the equivalent of this three-dimensional stacking - to our actual binary arrays - using the helpfully named <code class="docutils literal notranslate"><span class="pre">np.stack()</span></code> function. We can use <code class="docutils literal notranslate"><span class="pre">np.stack()</span></code> to - as the name implies - stack two 2D arrays into a 3D array, like in the image shown above. To do this, we stack over the third axis using the argument <code class="docutils literal notranslate"><span class="pre">axis=2</span></code>. This adds new arrays to the stack along the third dimension, when we count the dimensions from 0, as we do in Python indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stack the arrays in the third dimension.</span>
<span class="n">three_D_stack_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_ones_and_zeros</span><span class="p">,</span>
                                <span class="n">two_D_ones_and_zeros</span><span class="p">],</span>
                                <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_stack_array</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[1., 1.],
        [0., 0.]],

       [[0., 0.],
        [1., 1.]]])
</pre></div>
</div>
</div>
</div>
<p>At first glance, the “raw” output from Numpy may not look like the “stacked” slices in the image above, but please bear with us.
Our 3-D stacked array is of the right shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three_D_stack_array</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2, 2)
</pre></div>
</div>
</div>
</div>
<p>We can refer to each dimension in the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2,</span> <span class="pre">2)</span></code> as <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code>. These dimensions map to the image as shown below:</p>
<p><img alt="" src="_images/two_slice_dims.png" /></p>
<p>We can read this shape as “two slices, each with two rows and two columns”, which now clearly corresponds to the image.</p>
<p>Imagine being in the same physical space as these slices. Starting at the front of the image, you begin walking toward the first slice (nearest to the reader, in the foreground), then past it toward the second slice (furthest from the reader, in the background). So, in this imaginative exercise, you are walking along the <span class="math notranslate nohighlight">\(z\)</span> dimension.</p>
<p>We can use indexing operations to create the experience of this walk, in “Python space”. Because we are dealing with a three-dimensional array we use three elements for indexing, separated by commas. The first element is for rows, the second for columns, and the third for slices. We can retrieve the first slice using:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the first 2D slice from the 3D image.</span>
<span class="n">three_D_stack_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>And we can grab the second slice using:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the second 2D slice from the 3D image.</span>
<span class="n">three_D_stack_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>The image below shows these indexing operations represented in three-dimensional space:</p>
<p><img alt="" src="_images/two_slice_annotated.png" /></p>
<p>So far we have two slices in the third dimension. We can easily add a third slice, using <code class="docutils literal notranslate"><span class="pre">np.stack()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a third slice.</span>
<span class="n">three_D_stack_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_ones_and_zeros</span><span class="p">,</span>
                                <span class="n">two_D_ones_and_zeros</span><span class="p">,</span>
                                <span class="n">two_D_ones_and_zeros</span><span class="p">],</span> <span class="c1"># Add a third slice in the third dimension.</span>
                                <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_stack_array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[1., 1., 1.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [1., 1., 1.]]])
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">shape</span></code> of this new array now reads as “three slices, each with two rows and two columns”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three_D_stack_array</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2, 3)
</pre></div>
</div>
</div>
</div>
<p>We can visualise this new array, in the same three-dimensional space:</p>
<p><img alt="" src="_images/three_slice.png" /></p>
<p>Again, we can use indexing to “walk” through the slices, along the <span class="math notranslate nohighlight">\(z\)</span> dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 2-D slice of the stack.</span>
<span class="n">three_D_stack_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second 2-D slice of the stack.</span>
<span class="n">three_D_stack_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third 2-D slice of the stack.</span>
<span class="n">three_D_stack_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="_images/three_slice_annotated.png" /></p>
<p>So far we have visualised these slices using a similar graphic to depicting an individual slice using the <code class="docutils literal notranslate"><span class="pre">gray</span></code> Matplotlib colourmap. We can just as well visualise the slices using the numbers they contain:</p>
<p><img alt="" src="_images/three_slice_nums_only_annotated.png" /></p>
<p>Remember, the actual numbers in each “slice” are of the <code class="docutils literal notranslate"><span class="pre">float64</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code> and so contain (empty) decimal places. However, we will show the numbers just as 0 or 1, to keep the image uncluttered. Above we said we wanted to introduce a third dimension to introduce “true” colour information into the image. Well, now we have three dimensions surely plotting our image will render a vibrantly coloured picture?:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ooof...not what we wanted...</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_stack_array</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a552b69d410cf7c4942dcfc6cdee2f83086e428722358481187b8cbee2d983d.png" src="_images/1a552b69d410cf7c4942dcfc6cdee2f83086e428722358481187b8cbee2d983d.png" />
</div>
</div>
<p>Ok, that is not what we wanted - nothing has changed! Interestingly though, the 3-D image array still renders as a 2-D display image:</p>
<p><img alt="" src="_images/three_slice_all_1s.png" /></p>
<p>What happens if we set every element, in every slice, to equal 0? To do this, first we create a 2-D, 4-pixel array containing only 0’s:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 4-pixel array containing only 0&#39;s.</span>
<span class="n">two_D_zeros</span> <span class="o">=</span> <span class="n">two_D_ones_and_zeros</span> <span class="o">*</span> <span class="mf">0.</span>

<span class="n">two_D_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>Then, we stack into three dimensions with <code class="docutils literal notranslate"><span class="pre">np.stack()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stack three of these arrays, making a 3-D array containing only 0&#39;s.</span>
<span class="n">three_D_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_zeros</span><span class="p">,</span>
                          <span class="n">two_D_zeros</span><span class="p">,</span> 
                          <span class="n">two_D_zeros</span><span class="p">],</span>
                          <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[0., 0., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 0., 0.]]])
</pre></div>
</div>
</div>
</div>
<p>We can visualise this new 3-D array as:</p>
<p><img alt="" src="_images/three_slice_zeros.png" /></p>
<p>Next, we plot with Matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the 3-D array which contains only 0s.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_zeros</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7b3bf6ec6733f034d35529723aa390636c37806db78bee8308a4a14eb898699d.png" src="_images/7b3bf6ec6733f034d35529723aa390636c37806db78bee8308a4a14eb898699d.png" />
</div>
</div>
<p>Ok, so now we have a fully black 2-D display image, from our 3-D array which contains only 0’s:</p>
<p><img alt="" src="_images/three_slice_zeros_visualised.png" /></p>
<p>As an experiment, let’s see what happens if put 1’s on the diagonal in the <em>first slice only</em>. To do this, we will stack the <code class="docutils literal notranslate"><span class="pre">two_D_ones_and_zeros</span></code> array as the first slice, and <code class="docutils literal notranslate"><span class="pre">two_D_zeros</span></code> as the other two slices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array (for the first slice).</span>
<span class="n">two_D_ones_and_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array (for the second and third slices).</span>
<span class="n">two_D_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three_D_stack_array_altered_first</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_ones_and_zeros</span><span class="p">,</span> <span class="c1"># LOOK HERE!</span>
                                              <span class="n">two_D_zeros</span><span class="p">,</span> 
                                              <span class="n">two_D_zeros</span><span class="p">],</span> 
                                              <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_stack_array_altered_first</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[1., 0., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [1., 0., 0.]]])
</pre></div>
</div>
</div>
</div>
<p>More intuitively visualised, our new three dimensional array looks like this:</p>
<p><img alt="" src="_images/three_slice_red.png" /></p>
<p>You can see the values of 1 in the top left and bottom right elements of the first slice, all other elements are 0. Once more we can “walk” along the <span class="math notranslate nohighlight">\(z\)</span> dimension, using indexing operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_first</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_first</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_first</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>Now let’s see what happens if we plot this new 3-D array using Matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_stack_array_altered_first</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cbc6c90b7bb148e2a1f3a3df57d9f47bfcafbc5e45acc55a67dbee3d9ae54ad3.png" src="_images/cbc6c90b7bb148e2a1f3a3df57d9f47bfcafbc5e45acc55a67dbee3d9ae54ad3.png" />
</div>
</div>
<p>Great! We have now used the third dimension to introduce <em>true colour information</em> into our image array. We can visualise this process using the graphic below:</p>
<p><img alt="" src="_images/three_slice_red_visualised.png" /></p>
<p>Just to clarify, again our <em>array image</em> is three-dimensional, but our <em>display image</em> - e.g. the image rendered/displayed by Matplotlib - is two-dimensional, like the visualisations we saw earlier. In virtue of being 3-D, the image array itself contains three values for each array pixel - with one value in each “slice” in the third dimension.</p>
<p>To produce this red and black square, we altered the <em>first slice</em> of the 3-D array, such that it contains 1’s along its diagonal, but all other elements in the array are 0’s.</p>
<p>The first slice of the third dimension - in our 3-D image array - controls the amount of red in the image. We can therefore (for now) call this slice the <em>red slice</em>.</p>
<p>What happens if we alter only the <em>second slice</em> in the third dimension, so that only it contains 1’s along its diagonal, and all other array elements equal 0?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three_D_stack_array_altered_second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_zeros</span><span class="p">,</span> 
                                               <span class="n">two_D_ones_and_zeros</span><span class="p">,</span> <span class="c1"># LOOK HERE! Now we alter only the second slice.</span>
                                               <span class="n">two_D_zeros</span><span class="p">],</span> 
                                               <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_stack_array_altered_second</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[0., 1., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 1., 0.]]])
</pre></div>
</div>
</div>
</div>
<p>We can visualise this new 3-D array as:</p>
<p><img alt="" src="_images/three_slice_green.png" /></p>
<p>We can proceed with another “walk” through the image again, with the familiar indexing operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 2-D place of the stack.</span>
<span class="n">three_D_stack_array_altered_second</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second 2-D place of the stack.</span>
<span class="n">three_D_stack_array_altered_second</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_second</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>How does this 3-D array look when we visualise it with Matplotlib?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_stack_array_altered_second</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/28d407c38c12bca9527c77719661235506c1799a0b5faad61563652bab6d8d33.png" src="_images/28d407c38c12bca9527c77719661235506c1799a0b5faad61563652bab6d8d33.png" />
</div>
</div>
<p>Here we have altered only the second slice, such that only it contains nonzero (1) values. We now see green squares in the display image:</p>
<p><img alt="" src="_images/three_slice_green_visualised.png" /></p>
<p>Alterations to the second slice in the third dimension control the amount of green in the image - the second slice in the third dimension is therefore the <em>green slice</em>.</p>
<p>For completeness, let’s change only the <em>third slice</em> in the third dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Put 1 values in the third slice only.</span>
<span class="n">three_D_stack_array_altered_third</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_zeros</span><span class="p">,</span>
                                              <span class="n">two_D_zeros</span><span class="p">,</span> 
                                              <span class="n">two_D_ones_and_zeros</span> <span class="p">],</span> <span class="c1"># LOOK HERE!</span>
                                              <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">three_D_stack_array_altered_third</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[0., 0., 1.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 0., 1.]]])
</pre></div>
</div>
</div>
</div>
<p>Which gives us the following stacked slices:</p>
<p><img alt="" src="_images/three_slice_blue.png" /></p>
<p>…and the following “walk” through the slices, via array indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_third</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_third</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Third 2-D slice of the stack.</span>
<span class="n">three_D_stack_array_altered_third</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Finally, when plotted, we get:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_stack_array_altered_third</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c1f03a660dbfb74c599f933d3ecb0fcda27d1ca86928a4a28058b29bf342cf4a.png" src="_images/c1f03a660dbfb74c599f933d3ecb0fcda27d1ca86928a4a28058b29bf342cf4a.png" />
</div>
</div>
<p>So, this has given us:</p>
<p><img alt="" src="_images/three_slice_blue_visualised.png" /></p>
<section id="colour-channels">
<h2>Colour channels<a class="headerlink" href="#colour-channels" title="Link to this heading">#</a></h2>
<p>What is happening here?</p>
<p>Recall that we referred to the 2-D arrays that we used at the start of this tutorial as <em>single-channel image arrays</em>? The 3-D arrays we just created are  <em>three-channel image arrays</em>. This means that each array pixel has three values, one in each slice of the 3-D stacks we created. You can think of each slice as being one <em>colour channel</em>. Each colour channel controls the amount of a specific colour in the image, depending on the values of the array pixels in that slice.</p>
<p>Using these three-channel arrays, when Matplotlib produces the a two-dimensional <em>display image</em> (e.g. the matrix with coloured squares along the diagonal and black squares elsewhere). However, behind this 2-D display image there are three slices in the third dimension, each with the same number of rows and columns as the final 2-D display image. Each pixel (e.g. each array element) in the display image gets its colour information from a mix of the corresponding elements in each slice in the 3-D image array.</p>
<p>As we have seen, the first slice is the red channel, the second slice is the green channel and the third slice is the blue channel. The intensities in each colour channel are <em>mixed</em> to produce the rendered 2-D image:</p>
<p><img alt="" src="_images/colour_channels_all.png" /></p>
<p>Now, the way we have setup each 3-D array <em>is</em> mixing the colour channels, but because we have set two of the slices to contain only 0’s, we are essentially “switching off” those colour channel in the final mix (e.g. in the image displayed by Matplotlib). Other colours can be created using different blends of these primary colours (red, green, blue). For <code class="docutils literal notranslate"><span class="pre">float64</span></code> image data, you can think of 0 as meaning 0% and 1 as meaning 100%, 0.5 meaning 50% and so on. So a 1 in the red slice means 100% red is mixed in for that pixel, along with the percentages from the other colour channels (which in the arrays above, are 0’s).</p>
<p>We can see this by choosing intensity values randomly for each colour channel. The function <code class="docutils literal notranslate"><span class="pre">np.random.uniform()</span></code> can supply us with three random decimal numbers between 0 and 1. Run the cell below a few times if you are using this tutorial interactively, to see the random draw a few times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Three random integers.</span>
<span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X1 = </span><span class="si">{</span><span class="n">X1</span><span class="si">}</span><span class="se">\n</span><span class="s2">X2 = </span><span class="si">{</span><span class="n">X2</span><span class="si">}</span><span class="se">\n</span><span class="s2">X3 = </span><span class="si">{</span><span class="n">X3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X1 = 0.37
X2 = 0.87
X3 = 0.98
</pre></div>
</div>
</div>
</div>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">X1</span></code> value from this random draw to set nonzero diagonal values in the <em>red</em> colour channel (e.g. in the <em>first</em> slice of the stack).</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">X2</span></code> value from this random draw to set nonzero diagonal values in the <em>green</em> colour channel (e.g. in the <em>second</em> slice of the stack).</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">X3</span></code> value from this random draw to set nonzero diagonal values in  the <em>blue</em> colour channel (e.g. in the <em>third</em> slice of the stack).</p>
<p>We will then view the resulting display image. Again, if you are using this tutorial interactively, run the cell a few times to see multiple random mixes across the colour channels:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get three random integers between 0 and 255</span>
<span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Display the values of the random integers.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Red (X1) = </span><span class="si">{</span><span class="n">X1</span><span class="si">}</span><span class="se">\n</span><span class="s2">Green (X2) = </span><span class="si">{</span><span class="n">X2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Blue (X3) = </span><span class="si">{</span><span class="n">X3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create a 3-D stack, with the nonzero values in each slice set by the</span>
<span class="c1"># random integers.</span>
<span class="n">three_D_stack_array_altered_blend</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">two_D_ones_and_zeros</span> <span class="o">*</span> <span class="n">X1</span><span class="p">,</span>
                                             <span class="n">two_D_ones_and_zeros</span> <span class="o">*</span> <span class="n">X2</span><span class="p">,</span>
                                             <span class="n">two_D_ones_and_zeros</span> <span class="o">*</span> <span class="n">X3</span><span class="p">],</span> 
                                             <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Visualise the 3-D stack with Matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">three_D_stack_array_altered_blend</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Red (X1) = 0.04
Green (X2) = 0.71
Blue (X3) = 0.53
</pre></div>
</div>
<img alt="_images/2540c07e3c42bd68caf9a071ca3a31b3734467c4cca680aca77d92e517f3861d.png" src="_images/2540c07e3c42bd68caf9a071ca3a31b3734467c4cca680aca77d92e517f3861d.png" />
</div>
</div>
<p>So, each two-dimensional display image has a “hidden” three-dimensional array behind it. Each slice of the third dimension is a colour channel. The mix of values at a given element in each colour channel determins the colour of that pixel in the rendered image. You may want to view this image in a new browser window, to see more clearly the exact mixes of the colour channels, which are shown above each square on the right hand side of the image:</p>
<p><img alt="" src="_images/three_slice_algebraic_multi.png" /></p>
<p>You can view lots of random mixes across the colour channels, as a grid of plots, by running the cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A custom function to demonstrate many mixes of values across the three</span>
<span class="c1"># colour channels.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">random_colours</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_colour_array</span>
<span class="n">random_colour_array</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2f8384bc4f284a3a0d4a78146225d5c828bb23df001eb66bdb596056d0b3a1ec.png" src="_images/2f8384bc4f284a3a0d4a78146225d5c828bb23df001eb66bdb596056d0b3a1ec.png" />
</div>
</div>
<p>We have now completed our perilous expedition into the third dimension… We have seen that we can use 3-D arrays to encode <em>true colour</em> information. This means that the image array itself contains colour information for each pixel, where we are <em>not</em> just pseudocolouring greyscale information using <code class="docutils literal notranslate"><span class="pre">viridis</span></code> or another colourmap…</p>
<p>Let’s explore a colour image of a real object. We will introduce Scikit-image (<code class="docutils literal notranslate"><span class="pre">skimage</span></code>) in more detail on the <a class="reference internal" href="2_skimage_intro.html"><span class="doc std std-doc">next page</span></a>, but for now we will again use the straightforwardly named <code class="docutils literal notranslate"><span class="pre">imread()</span></code> function to load an image from a file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the input/output module from skimage.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">io</span>

<span class="c1"># Load our image array.</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/coffee.png&quot;</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; array output.</span>
<span class="n">coffee</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 21,  13,   8],
        [ 21,  13,   9],
        [ 20,  11,   8],
        ...,
        [228, 182, 138],
        [231, 185, 142],
        [228, 184, 140]],

       [[ 21,  13,   7],
        [ 21,  13,   9],
        [ 20,  14,   7],
        ...,
        [228, 182, 136],
        [231, 185, 139],
        [229, 183, 137]],

       [[ 21,  14,   7],
        [ 23,  13,  10],
        [ 20,  14,   9],
        ...,
        [228, 182, 136],
        [228, 184, 137],
        [229, 185, 138]],

       ...,

       [[189, 124,  77],
        [214, 155, 109],
        [197, 141, 100],
        ...,
        [165,  86,  37],
        [161,  82,  41],
        [143,  67,  29]],

       [[207, 148, 102],
        [201, 142,  99],
        [196, 140,  97],
        ...,
        [154,  74,  37],
        [147,  66,  33],
        [145,  65,  31]],

       [[197, 141, 100],
        [195, 137,  99],
        [193, 138,  98],
        ...,
        [158,  73,  38],
        [144,  64,  30],
        [143,  60,  29]]], shape=(400, 600, 3), dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>The cell below defines a function to let us quickly view the attributes of any image array. You’ll noticed that this function just uses NumPy attributes, given that we are representing images as nothing but NumPy arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">show_attributes</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dtype:&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max Pixel Value:&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min Pixel Value:&quot;</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect the attributes of the `coffee` image array.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">coffee</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (400, 600, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<p>We can see that this image has three dimensions, with three slices in the third dimension. We are therefore dealing with <em>true colour</em> image with three colour channels. We can also see that the image array represents the most intense pixel values with the number 255, and the least intense values with the number 0, in each colour channel. The <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is <code class="docutils literal notranslate"><span class="pre">uint8</span></code>, in contrast the <code class="docutils literal notranslate"><span class="pre">float64</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code> we have been using in our custom made low-resolution image arrays.</p>
<p>Let’s view the image with <code class="docutils literal notranslate"><span class="pre">imshow()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9bea863298662798dfd8805b3e1b6dd347615d6f709ac06138bb0736d6c06c7b.png" src="_images/9bea863298662798dfd8805b3e1b6dd347615d6f709ac06138bb0736d6c06c7b.png" />
</div>
</div>
<p>Looks great! Though at the time of writing one of the authors is on their third coffee today…</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pixels-and-dtype">
<h1>Pixels and <code class="docutils literal notranslate"><span class="pre">dtype</span></code><a class="headerlink" href="#pixels-and-dtype" title="Link to this heading">#</a></h1>
<p>Why is the highest pixel value in the <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image the bizarrely specific integer value of 255? We will talk more about image data types <a class="reference internal" href="2_skimage_intro.html"><span class="doc std std-doc">later</span></a>, but other values/<code class="docutils literal notranslate"><span class="pre">dtypes</span></code> would work here as well. For the two <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s we have seen, the conventions are:</p>
<p>0 - 1: where 0 is the least intense, 1 is the most intense (<code class="docutils literal notranslate"><span class="pre">float64</span></code>).</p>
<p>0 - 255: where 0 is the least intense, 255 is the most intense (<code class="docutils literal notranslate"><span class="pre">uint8</span></code>).</p>
<p>You will see both conventions in images you encounter “in the wild”, and Sci-kit image supports both formats (as well as multiple other formats - see the table below). Neglecting to pay attention to <code class="docutils literal notranslate"><span class="pre">dtype</span></code> is a very common source of errors when dealing with image arrays, so keep track of it, and deliberately specify it as often as possible!</p>
<p><img alt="" src="_images/dtypes_skimage.png" /></p>
<p>The plot below shows how to get the primary colours (red, green, blue) using both the <code class="docutils literal notranslate"><span class="pre">float64</span></code> and <code class="docutils literal notranslate"><span class="pre">unint8</span></code> convention for the maximum and minimum pixel values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use a custom function to plot the maximum intensity values in the diagonals, for `int` and `float` data,</span>
<span class="c1"># using our familiar 1&#39;s and 0&#39;s array.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">random_colours</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_int_float</span>
<span class="n">plot_int_float</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/015b8b709360602cd44fd897cd18710d18ef3035724e49b0417d1f84724483fa.png" src="_images/015b8b709360602cd44fd897cd18710d18ef3035724e49b0417d1f84724483fa.png" />
</div>
</div>
<p>Ok, now we have clarified the mystical 255 pixel value, let’s use a for loop to extract each colour channel of <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image. What do you think Matplotlib will show when we visualise each 2-D slice of the 3-D image separately?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The name of each colour channel.</span>
<span class="n">RGB_chan_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Red Channel&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Green Channel&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Blue Channel&quot;</span><span class="p">]</span>

<span class="c1"># Loop through, extract each channel as a 2-D slice, and visualise.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">RGB_chan_names</span><span class="p">)):</span>
        <span class="n">chan_name</span> <span class="o">=</span> <span class="n">RGB_chan_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">current_slice</span> <span class="o">=</span> <span class="n">coffee</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">chan_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_slice</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Shape: </span><span class="si">{</span><span class="n">current_slice</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a234b9a9ee62a62cd53d24d6db4a36278e8c762832f995b3c431831afd557bbc.png" src="_images/a234b9a9ee62a62cd53d24d6db4a36278e8c762832f995b3c431831afd557bbc.png" />
</div>
</div>
<p>Now we are viewing each slice/colour channel separately, we are again visualising 2-D arrays - you can see the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> of each slice below each image.</p>
<p>The image from each colour channel, when visualised separately, is now essentially a single-channel image, and so Matplotlib is rendering it in greyscale. As we know, we could also use the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> colourmap to pseudocolour the greyscale information in the images for the purposes of the display. Though in this instance, <code class="docutils literal notranslate"><span class="pre">viridis</span></code> results in some slightly queasy-looking images:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pseudo-colour with `viridis`.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">RGB_chan_names</span><span class="p">)):</span>
        <span class="n">chan_name</span> <span class="o">=</span> <span class="n">RGB_chan_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">current_slice</span> <span class="o">=</span> <span class="n">coffee</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">chan_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_slice</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Shape: </span><span class="si">{</span><span class="n">current_slice</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8e78d7c51d45b6622f252b1062ad7a9e9f4f605531632cc8dd9cb763d221e9fc.png" src="_images/8e78d7c51d45b6622f252b1062ad7a9e9f4f605531632cc8dd9cb763d221e9fc.png" />
</div>
</div>
<p>When we visualise the full 3-D array however, then, as we have seen, each slice controls the amount of a specific colour, and the resultant mix gives us our beautiful, full colour image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9bea863298662798dfd8805b3e1b6dd347615d6f709ac06138bb0736d6c06c7b.png" src="_images/9bea863298662798dfd8805b3e1b6dd347615d6f709ac06138bb0736d6c06c7b.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="true-blue">

<p class="admonition-title"><span class="caption-number">Exercise 2 </span></p>
<section id="exercise-content">
<p>Now over to you for some NumPy-fuelled colour wizardry. Your job is take our binary <code class="docutils literal notranslate"><span class="pre">two_D_ones_and_zeros</span></code> array and to use numerical and/or NumPy operations <strong>only</strong> to manipulate the image so that it looks as follows, when displayed with <code class="docutils literal notranslate"><span class="pre">plt.matshow()</span></code>:</p>
<p><img alt="" src="_images/all_blue.png" /></p>
<p>An array called <code class="docutils literal notranslate"><span class="pre">all_blue</span></code> contains your raw materials…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show `two_D_ones_and_zeros`.</span>
<span class="n">two_D_ones_and_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">all_blue</span> <span class="o">=</span> <span class="n">two_D_ones_and_zeros</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="1_colour_images_as_numpy_arrays-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#true-blue"> Exercise 2</a></p>
<section id="solution-content">
<p>The solution here is to <code class="docutils literal notranslate"><span class="pre">np.stack</span></code> a new three-channel array, and then to use some simple NumPy indexing to adjust the colour of the image. You can “turn off” the Red and Green colour channels by setting the pixel values in the first and second slice to 0. You can then “max out” the Blue colour channel by setting <em>all</em> of the pixel values in the third slice to 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy the original array.</span>
<span class="n">all_blue_solution</span> <span class="o">=</span> <span class="n">two_D_ones_and_zeros</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Stack the array into 3-D.</span>
<span class="n">all_blue_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">all_blue_solution</span><span class="p">,</span>
                              <span class="n">all_blue_solution</span><span class="p">,</span>
                              <span class="n">all_blue_solution</span><span class="p">],</span>
                              <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> 

<span class="c1"># &quot;Turn off&quot; the first two colour channels, in all array pixels.</span>
<span class="n">all_blue_solution</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># &quot;Max out&quot; the Blue colour channel, in all array pixels.</span>
<span class="n">all_blue_solution</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="c1"># Show the result.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">all_blue_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ca755f2d58860dfaea76e3ed1e198df8224d3d1b1fdc202c618b07d78eee1db5.png" src="_images/ca755f2d58860dfaea76e3ed1e198df8224d3d1b1fdc202c618b07d78eee1db5.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="blood-smile">

<p class="admonition-title"><span class="caption-number">Exercise 3 </span></p>
<section id="exercise-content">
<p>Time for some more horrifying computer art. Your task now is to modify the <code class="docutils literal notranslate"><span class="pre">smiley</span></code> image from earlier, using only numerical and/or NumPy operations, to make a “blood smiley”. The new “blood smiley” should have a black background, and a red face, meaning that Matplotlib will render it as:</p>
<p><img alt="" src="_images/blood_smile.png" /></p>
<p>Once more, your raw ingredients are in the cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">blood_smiley</span> <span class="o">=</span> <span class="n">smiley</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="1_colour_images_as_numpy_arrays-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#blood-smile"> Exercise 3</a></p>
<section id="solution-content">
<p>The solution here is simple. The background in the image is already black, meaning that for those pixels, the array pixels values are already 0. When we <code class="docutils literal notranslate"><span class="pre">np.stack()</span></code> the array into 3-D, we just need to set the 1 values, corresponding to the “face” pixels, to be 1’s the Red channel only, and 0’s in the other slices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Horrific!</span>
<span class="n">smiley_red_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">smiley</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> 
                                <span class="n">smiley</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="n">smiley</span> <span class="o">*</span> <span class="mi">0</span><span class="p">],</span> 
                                <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">smiley_red_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bd1cf2fbd41a4f8a1a9b3087e1f85fb4121c882d733806dfc8003a236398b6b6.png" src="_images/bd1cf2fbd41a4f8a1a9b3087e1f85fb4121c882d733806dfc8003a236398b6b6.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="inverted-blood-smile">

<p class="admonition-title"><span class="caption-number">Exercise 4 </span></p>
<section id="exercise-content">
<p>When we “invert” the colour of an image this means we reverse the intensity values. So the highest values become the lowest, and the lowest values become the highest.</p>
<p>Your job is to figure out how, again using only numerical or NumPy operations on the <code class="docutils literal notranslate"><span class="pre">smiley</span></code> image, to produce this final result:</p>
<p><img alt="" src="_images/inverted_blood_smiley.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">inverted_blood_smiley</span> <span class="o">=</span> <span class="n">smiley</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="1_colour_images_as_numpy_arrays-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#inverted-blood-smile"> Exercise 4</a></p>
<section id="solution-content">
<p>Because <code class="docutils literal notranslate"><span class="pre">smiley</span></code> is a binary array, we can invert the values with a simple numerical operation: subtracting 1 from the array so 0 becomes -1, and 1 becomes 0. Then by adding 1 to the result, -1 becomes 0 and zero becomes 1, we “invert” the original values.</p>
<p>Below is the solution to invert <code class="docutils literal notranslate"><span class="pre">smiley</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1 - invert the original array</span>
<span class="n">inverted_blood_smiley_solution</span> <span class="o">=</span> <span class="p">(</span><span class="n">smiley</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inverted_blood_smiley_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_blood_smiley_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 0. 1. 1. 0. 1. 1.]
 [1. 1. 0. 1. 1. 0. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 0. 1. 1. 1. 1. 0. 1.]
 [1. 0. 0. 1. 1. 0. 0. 1.]
 [1. 1. 0. 0. 0. 0. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]]
</pre></div>
</div>
<img alt="_images/df02d36b2f9266e588b236ecffba5cb347ef43da9210731ebbc2ef641aedc547.png" src="_images/df02d36b2f9266e588b236ecffba5cb347ef43da9210731ebbc2ef641aedc547.png" />
</div>
</div>
<p>We can then stack the inverted array and “turn off” the green and blue channels by multiplying their pixel values by 0:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 2 - add the colour channels</span>
<span class="n">inverted_blood_smiley_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">inverted_blood_smiley_solution</span><span class="p">,</span> 
                                     <span class="n">inverted_blood_smiley_solution</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                                     <span class="n">inverted_blood_smiley_solution</span> <span class="o">*</span> <span class="mi">0</span><span class="p">],</span> 
                                     <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_blood_smiley_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a9c005f22ad0d2f83242745a38f37b6f4f2a370ac63af943147efdab7b9b459b.png" src="_images/a9c005f22ad0d2f83242745a38f37b6f4f2a370ac63af943147efdab7b9b459b.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="colourless-caffeine">

<p class="admonition-title"><span class="caption-number">Exercise 5 </span></p>
<section id="exercise-content">
<p>Ok, that was all scary. Now we need a coffee to relax (is coffee relaxing?!).</p>
<p>Your next task is to take the <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image and use only numerical or NumPy operations to convert it to a single-channel (e.g. monochrome image):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">colourless_coffee</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="1_colour_images_as_numpy_arrays-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#colourless-caffeine"> Exercise 5</a></p>
<section id="solution-content">
<p>There are several ways to do this. One way is to use the <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">coffee</span></code> NumPy array, setting <code class="docutils literal notranslate"><span class="pre">axis=2</span></code> to average across the colour channels in the third dimension.</p>
<p>The resulting output is 2-D, and therefore single-channel/monochrome:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution 1</span>
<span class="n">colourless_coffee_solution</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colourless_coffee_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6697af07b50845bef23125a8c320206623cbc073b01709db6c32db7fc8bfb8a9.png" src="_images/6697af07b50845bef23125a8c320206623cbc073b01709db6c32db7fc8bfb8a9.png" />
</div>
</div>
<p>Another way is just to use NumPy indexing to extract one colour channel slice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution 2</span>
<span class="n">colourless_coffee_solution</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">copy</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colourless_coffee_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ca4478dcd352127db2c0d6d4565c3e88a5ceeb77235c02919c43cce23dff878d.png" src="_images/ca4478dcd352127db2c0d6d4565c3e88a5ceeb77235c02919c43cce23dff878d.png" />
</div>
</div>
<p>Because the intensity values are different in each colour channel slice, the slice we choose will change the resulting image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use a different slice.</span>
<span class="n">colourless_coffee_solution</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">copy</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colourless_coffee_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4640c05d99069419ed6ce3f4550cdcd61fbbfa5ddb1e2bf485af8968015063eb.png" src="_images/4640c05d99069419ed6ce3f4550cdcd61fbbfa5ddb1e2bf485af8968015063eb.png" />
</div>
</div>
<p>…we will allow any slice as the correct solution, however, as they are all greyscale.</p>
</section>
</div>
<div class="exercise dropdown admonition" id="corrupted-camera">

<p class="admonition-title"><span class="caption-number">Exercise 6 </span></p>
<section id="exercise-content">
<p>In image processing “signal” can very roughly be thought of as a meaningful visual representation of something, in pixel values. Conversely, noise can be thought of as meaningless randomness in pixel values.</p>
<p>Your job now, like an aging memory card or broken file system, is to corrupt the <code class="docutils literal notranslate"><span class="pre">camera</span></code> image below with some noisy pixels.</p>
<p>Here is the original image:</p>
<p><img alt="" src="_images/camera_plot.png" /></p>
<p>You should use NumPy and numerical operations only, to create the following image:</p>
<p><img alt="" src="_images/corrupted_camera.png" /></p>
<p>Your final image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p><em>Hint 1</em>: this sort of noise is <em>random</em>, you can think about functions in the <code class="docutils literal notranslate"><span class="pre">np.random</span></code> module which might be of use here…</p>
<p><em>Hint 2</em>: to work out what values should random, it may help to pay attention to the colour of the noisy region…</p>
<p><em>Hint 3</em>: run the function <code class="docutils literal notranslate"><span class="pre">hint_corrupted_camera()</span></code> for additional help…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the camera image.</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/camera.png&quot;</span><span class="p">)</span>

<span class="c1"># Show the attributes of `camera`/</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="n">noisy_camera</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="1_colour_images_as_numpy_arrays-solution-9">

<p class="admonition-title">Solution to<a class="reference internal" href="#corrupted-camera"> Exercise 6</a></p>
<section id="solution-content">
<p>The way we did this was by stacking <code class="docutils literal notranslate"><span class="pre">camera</span></code> into a 3-D array. We then used NumPy indexing to isolate a region around the cameraman’s face in the green colour channel (second slice). We used the <code class="docutils literal notranslate"><span class="pre">np.random.permutation()</span></code> function to shuffle (e.g. randomize) the pixel values in this region:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">noisy_camera_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">camera</span><span class="p">,</span> 
                                  <span class="n">camera</span><span class="p">,</span>
                                  <span class="n">camera</span><span class="p">],</span> 
                                  <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">noisy_camera_solution</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="mi">190</span><span class="p">:</span><span class="mi">260</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">noisy_camera_solution</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="mi">190</span><span class="p">:</span><span class="mi">260</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">noisy_camera_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a6ebb31fcc875b5ac5409f95095bb481f990600d18f2243c98a69810cc177a23.png" src="_images/a6ebb31fcc875b5ac5409f95095bb481f990600d18f2243c98a69810cc177a23.png" />
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="more-actually-complex-images">
<h1>More (actually) complex images<a class="headerlink" href="#more-actually-complex-images" title="Link to this heading">#</a></h1>
<p>So far we have looked at simple images - 2-D binary and greyscale low-resolution image arrays, like <code class="docutils literal notranslate"><span class="pre">smiley</span></code> - or more complex colour images with three colour channels (like <code class="docutils literal notranslate"><span class="pre">coffee</span></code>). However, the principles we have seen extend to even more complex images, like the image arrays generated by <a class="reference external" href="https://en.wikipedia.org/wiki/Neuroimaging">brain imaging</a>, for instance.</p>
<p>Here is an image of one “slice” of one of the authors brains, which was captured by a <a class="reference external" href="https://en.wikipedia.org/wiki/Magnetic_resonance_imaging">magnetic resonance imaging</a> scanner:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># One author&#39;s own brain (a 2-D slice).</span>
<span class="n">brain</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/pxr_brain.png&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">brain</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3ae0f16cfa2b3e1abda88fc5ea5172a007e3b0b5aa62a0b7f3c6db719422f1d.png" src="_images/d3ae0f16cfa2b3e1abda88fc5ea5172a007e3b0b5aa62a0b7f3c6db719422f1d.png" />
</div>
</div>
<p>The physics of magnetic resonance imaging are very complicated, but the image arrays that it produces, as with our very simple low-resolution arrays, are nothing but arrays of numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the attributes of the brain image.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">brain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (3720, 3493)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<p>Note that this image is 2-D, and it is actually a relatively simple brain image. Other brain images can also contain <em>time</em> information - e.g. an image of the brain through time, as it responds to different stimuli. Such images are actually 4-D, with an extra dimension for temporal information. However, all of these images can still be represented as NumPy arrays, with varying dimensionalities and various min/max pixel value conventions. Importantly, these higher-dimensional images do not always contain colour information - the way we have seen above is just one way of using higher-dimensional image arrays, to encode colour. We will investigate this topic more on the <a class="reference internal" href="2_skimage_intro.html"><span class="doc std std-doc">next page</span></a>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h1>
<p>On this page we have seen how colour can be represented in NumPy array images:</p>
<ul class="simple">
<li><p>Images are (at least) two-dimensional arrays of numbers. Multiple <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s in image arrays are supported by Sci-kit image.</p></li>
<li><p>We have seen images where the number at each array pixel location determines the grey-level (in a 2-D array) or colour (in a 3-D array) of that location when the image is displayed. For 3-D colour arrays the number in each slice/channel is summed to determine the colour in the 2-D displayed image.</p></li>
<li><p>These methods of colour encoding can apply to both to very simple and very complex images. Some types of image (e.g. brain images) use higher-dimensionality to encode information other than colour (e.g. time).</p></li>
</ul>
<p>On the <a class="reference internal" href="2_skimage_intro.html"><span class="doc std std-doc">next page</span></a> we will formally introduce Scikit-image, which uses NumPy image arrays as its fundamental representation of images.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<p>Adapted from: <a class="reference external" href="https://lectures.scientific-python.org/advanced/image_processing">https://lectures.scientific-python.org/advanced/image_processing</a></p>
<p>Adapted from: <a class="reference external" href="https://lectures.scientific-python.org/packages/scikit-image/index.html">https://lectures.scientific-python.org/packages/scikit-image/index.html</a></p>
<p>Reference: inspiration from Nipraxis also re: arrays/images.</p>
<p>Reference: inspiration from <code class="docutils literal notranslate"><span class="pre">skimage</span></code> tutorials</p>
<p>Reference: <a class="reference external" href="https://bic-berkeley.github.io/psych-214-fall-2016/arrays_and_images.html">https://bic-berkeley.github.io/psych-214-fall-2016/arrays_and_images.html</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="0_images_as_numpy_arrays.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">What is an image? - Images as NumPy arrays</p>
      </div>
    </a>
    <a class="right-next"
       href="2_skimage_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introducing Scikit-image</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">What about colour?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#true-colour-in-3d">True Colour in 3D</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colour-channels">Colour channels</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pixels-and-dtype">Pixels and <code class="docutils literal notranslate"><span class="pre">dtype</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-actually-complex-images">More (actually) complex images</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Rush, Matthew Brett
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>