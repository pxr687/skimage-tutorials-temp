
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>(Sci-kit) Image processing, via NumPy and SciPy &#8212; Scikit-image via NumPy and SciPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3_skimage_processing_from_numpy_and_scipy';</script>
    <link rel="canonical" href="https://pxr687.github.io/skimage-tutorials-temp/3_skimage_processing_from_numpy_and_scipy.html" />
    <link rel="icon" href="_static/pandas_numpy.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Threshold filtering" href="4_threshold_filters.html" />
    <link rel="prev" title="Introducing Scikit-image" href="2_skimage_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/colorwheel.png" class="logo__image only-light" alt="Scikit-image via NumPy and SciPy - Home"/>
    <script>document.write(`<img src="_static/colorwheel.png" class="logo__image only-dark" alt="Scikit-image via NumPy and SciPy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Scikit-image via NumPy and SciPy</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_images_as_numpy_arrays.html">Images as NumPy arrays</a></li>

<li class="toctree-l1"><a class="reference internal" href="1_color_images_as_numpy_arrays.html">What about color?</a></li>

<li class="toctree-l1"><a class="reference internal" href="2_skimage_intro.html">Introducing Scikit-image</a></li>










<li class="toctree-l1 current active"><a class="current reference internal" href="#">(Sci-kit) Image processing, via NumPy and SciPy</a></li>













<li class="toctree-l1"><a class="reference internal" href="4_threshold_filters.html">Threshold filtering</a></li>






<li class="toctree-l1"><a class="reference internal" href="5_mean_filter.html">Convolution filters I - the mean filter</a></li>





<li class="toctree-l1"><a class="reference internal" href="6_gaussian_sharpening_edge.html">Convolution filters II - Gaussian blur, sharpening and edge detection</a></li>








<li class="toctree-l1"><a class="reference internal" href="7_median_nonlocal_filters.html">More filters: the median filter and non-local filters</a></li>






<li class="toctree-l1"><a class="reference internal" href="8_morphology.html">Morphology</a></li>







</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="interact/lab/index.html?path=3_skimage_processing_from_numpy_and_scipy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch via JupyterLite"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterLite logo" src="_static/images/logo_jupyterlite.svg">
  </span>
<span class="btn__text-container">JupyterLite</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/edit/main/3_skimage_processing_from_numpy_and_scipy.Rmd" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/issues/new?title=Issue%20on%20page%20%2F3_skimage_processing_from_numpy_and_scipy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3_skimage_processing_from_numpy_and_scipy.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(Sci-kit) Image processing, via NumPy and SciPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">(Sci-kit) Image processing, via NumPy and SciPy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image">Resizing an image</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image-with-skimage">Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation">Rotation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-an-image-with-skimage">Rotating an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cropping">Cropping</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-image-colors">Inverting image colors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-colors-with-skimage">Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#greyscale-to-binary-conversion">Greyscale to binary conversion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion">Color to grayscale conversion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-skimage">Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sci-kit-image-processing-via-numpy-and-scipy">
<h1>(Sci-kit) Image processing, via NumPy and SciPy<a class="headerlink" href="#sci-kit-image-processing-via-numpy-and-scipy" title="Link to this heading">#</a></h1>
<p>This page will explore foundational image processing techniques, as operations on the values in a NumPy image array. First, we will explore how to achieve specific effects using NumPy and SciPy. We will demonstrate what these operations are doing to an image at the level of the array pixels. After that, we will show how more sophisticated extensions of these techniques can be implemented with Scikit-image, focusing on how it is often the same NumPy and SciPy operations that Sci-kit image is using “under the hood”.</p>
<p>Remember that <em>image processing is when we do something which changes the numbers inside an image array, and therefore changes the corresponding visual image</em>? Well, in fact, all that even the fanciest image processing software is doing is just changing the pixel values inside image arrays, in various ways. This is true for image processing software with a graphical user interface, like <a class="reference external" href="https://www.adobe.com/th_en/products/photoshop">Adobe Photoshop</a>, as well as for code-based image processing software like Scikit-image.</p>
<p>Let’s again build a simple image array, and look at how we can use NumPy alone to achieve some pretty radical changes to the original image. We will then look at the specific purposes that such changes are used for, with more complex images.</p>
<p>First, we create our image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ski</span>

<span class="c1"># Import a custom function to give hints for some exercises.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hints</span><span class="w"> </span><span class="kn">import</span> <span class="n">hint_split_i</span><span class="p">,</span> <span class="n">hint_cryptic_camera</span>

<span class="c1"># Set precision for float numbers</span>
<span class="o">%</span><span class="k">precision</span> 2

<span class="c1"># Set &#39;gray&#39; as the default colormap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span>

<span class="c1"># A custom function for showing image attributes.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">show_attributes</span><span class="w"> </span><span class="kn">import</span> <span class="n">show_attributes</span>

<span class="c1"># Create our image array.</span>
<span class="n">i_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Show the image array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" src="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" />
</div>
</div>
<p>We have already encountered the use of <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> as a tool for rudimentary image manipulation. We use it to, well, flip an image array on its head:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flip the array.</span>
<span class="n">flipped_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; array pixel values.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flipped_i</span><span class="p">)</span>

<span class="c1"># Display the array with Matplotlib.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flipped_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/a3bf0b7d8f8d5676e397abcfa9351ac75014e6608e8700bd8f5857f87a7fff24.png" src="_images/a3bf0b7d8f8d5676e397abcfa9351ac75014e6608e8700bd8f5857f87a7fff24.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resizing-an-image">
<h1>Resizing an image<a class="headerlink" href="#resizing-an-image" title="Link to this heading">#</a></h1>
<p>Now, <em>any operation that changes the numbers in the array</em> is a form of image manipulation. The term <em>image processing</em> generally means we are applying image manipulations <em>to achieve a specific purpose</em> - like improving image quality or clarity, for instance.</p>
<p>Let’s say we want to <em>resize</em> our image array. Using NumPy, there are many ways to the same destination. Provided we want to <em>double</em> the size along a given dimension, we can achieve what we want using <code class="docutils literal notranslate"><span class="pre">np.repeat()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double the image, along the rows.</span>
<span class="n">doubled_i_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                           <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; array pixel values.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doubled_i_rows</span><span class="p">)</span>

<span class="c1"># Display the array with Matplotlib.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i_rows</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/399896efb095a580f055cdb4471b8bb74c8672a5c1b2f14e795b75f2a4182fa3.png" src="_images/399896efb095a580f055cdb4471b8bb74c8672a5c1b2f14e795b75f2a4182fa3.png" />
</div>
</div>
<p>We can compare the attributes, including the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of each array, using a custom function we defined in the first cell of this notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">doubled_i_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>We can see that we have twice the number of rows in the <code class="docutils literal notranslate"><span class="pre">doubled_i_rows</span></code> image.</p>
<p>We can also double along the columns, by setting <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double along the columns.</span>
<span class="n">doubled_i_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                           <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Show the result.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doubled_i_cols</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i_cols</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/8d3c258325665cc84adbe782d3d1a011bdb8bc9c58fea3a82ec7186645792e26.png" src="_images/8d3c258325665cc84adbe782d3d1a011bdb8bc9c58fea3a82ec7186645792e26.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Indeed, the columns have doubled.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">doubled_i_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 16)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>By combining these operations, we can double along both the rows and the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double the whole image.</span>
<span class="n">doubled_i</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                       <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                       <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">doubled_i</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">,</span> 
                       <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Show the result.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/67d25f9d766ea227394fa8d477f424eae08ecc7d18a23f6c9aef5ec763752b43.png" src="_images/67d25f9d766ea227394fa8d477f424eae08ecc7d18a23f6c9aef5ec763752b43.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The original image size was (15, 8).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 16)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="exercise dropdown admonition" id="i-!">

<p class="admonition-title"><span class="caption-number">Exercise 11 </span></p>
<section id="exercise-content">
<p>Your job now is to use NumPy operations <em>only</em> to create the following image array, using the <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array as your starting point:</p>
<p><img alt="" src="_images/eye-%21.png" /></p>
<p>Your final array should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<p><em>Hint</em>: you may want to investigate NumPy functions for combining arrays together…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">i_exclam</span> <span class="o">=</span> <span class="n">i_img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#i-!"> Exercise 11</a></p>
<section id="solution-content">
<p>You can do this in one line of code by using a combination of <code class="docutils literal notranslate"><span class="pre">np.concat()</span></code>, <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code>. Notably,<code class="docutils literal notranslate"><span class="pre">np.concat()</span></code> will “stick” arrays together, rather than <code class="docutils literal notranslate"><span class="pre">np.repeat()</span></code>-ing the values…</p>
<p>Combined with <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> we can produce the desired result in one line of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the two `i_img` arrays, flip the second.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">i_img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">i_img</span><span class="p">)]));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7555d567b57da84d0dc6b0502cb145920b5e16bebb4bb63334a403441ea83595.png" src="_images/7555d567b57da84d0dc6b0502cb145920b5e16bebb4bb63334a403441ea83595.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="split-i">

<p class="admonition-title"><span class="caption-number">Exercise 12 </span></p>
<section id="exercise-content">
<p>Here again is the <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array, and a printout of its attributes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" src="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" />
</div>
</div>
<p>Now, your task is to find a way, again using only NumPy, to alter the <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array so it becomes this target image:</p>
<p><img alt="" src="_images/split_i.png" /></p>
<p>The output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 7)
Max Pixel Value: 1.0
Min Pixel Value: -1.0
</pre></div>
</div>
<p><em>Note</em>: notice how we have lost a column, relative to the original <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array…We also now have -1 values in the array, have a think about which colors in the displayed image you think that these negative values will correspond to.</p>
<p><em>Hint:</em> run the function <code class="docutils literal notranslate"><span class="pre">hint_split_i()</span></code>, which was imported at the beginning of this notebook, to see a helpful hint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">split_i</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#split-i"> Exercise 12</a></p>
<section id="solution-content">
<p>The target image can be created using the <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> function, which calculates the difference between adjacent values in an array. By default <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> operates in steps of 1 across the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between values along the columns, in steps of 1.</span>
<span class="n">split_i_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; NumPy array.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">split_i_solution</span><span class="p">)</span>

<span class="c1"># Display the image.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">split_i_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]]
</pre></div>
</div>
<img alt="_images/b466fbed2ca920299e21f27fb7b310f85eaf174de5c87f2025a66f1a679106bd.png" src="_images/b466fbed2ca920299e21f27fb7b310f85eaf174de5c87f2025a66f1a679106bd.png" />
</div>
</div>
<p>Why is the background now gray? Well, remember that, for a monochrome image visualised with the <code class="docutils literal notranslate"><span class="pre">gray</span></code> colormap: the most intense (highest value) pixels are white, and the least intense (lowest value) pixels are black, and intermediate values are a shade of gray.</p>
<p>When we subtract along the column, with <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> the third value is subtracted from the fourth value etc., and so the resulting differences are calculated as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">1</span></code> for 1 values on the left-hand side of the original image, and…</p></li>
<li><p>…<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">-1</span></code> for 1 values on the right-hand side of the original image…</p></li>
<li><p>…and <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">0</span></code> for adjacent 1’s; <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code> for adjacent 0’s.</p></li>
</ul>
<p>Essentially we are detecting <em>edges</em> (big changes in intensity between adjacent pixels) in the horizontal direction (e.g. within each row, along the columns):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show before/after applying `np.diff()` to the image array.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Before:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">i_img</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">After:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">split_i_solution</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before:
 [[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]

After:
 [[ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]]
</pre></div>
</div>
</div>
</div>
<p>So our highest values are now 1, our lowest values are -1, and our intermediate values are 0 (e.g. where the difference between elements was calculated from <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code>, indicating no change in the <em>gradient</em> of pixel intensity). A range from -1 to 1 is still supported in <code class="docutils literal notranslate"><span class="pre">skimage</span></code> for the <code class="docutils literal notranslate"><span class="pre">float64</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
<p>White areas (pixel = 1) indicate a change between pixels in the horizontal direction (moving left-to-right) from black-to-white, in the original image. Black areas (pixel = -1) indicate a change in the horizontal direction from white-to-black. Grey areas indicate no change (pixel = 0).</p>
<p>We can detect big changes (edges) in the <em>vertical</em> direction by telling <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> to operate along the rows, rather than along the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertical_gradients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                             <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Subtract along the rows, not the columns.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vertical_gradients</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c3a75d27183b4534189e923ce95fea1c4155914b8cb597fd9a5cd3591987fae.png" src="_images/7c3a75d27183b4534189e923ce95fea1c4155914b8cb597fd9a5cd3591987fae.png" />
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resizing-an-image-with-skimage">
<h1>Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#resizing-an-image-with-skimage" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ski.transform</span></code> module contains a function called <code class="docutils literal notranslate"><span class="pre">resize</span></code>. It is probably easy to guess what <code class="docutils literal notranslate"><span class="pre">ski.transform.resize()</span></code> does. It takes an input image and changes its size (obviously!). Because all computer images are at least 2D arrays, this involves changing the dimensionality of the image. Let’s demonstrate this with the following image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an image array.</span>
<span class="n">squares</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span> 
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,]],</span> 
                   <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Show the array (&quot;raw&quot; output from NumPy)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squares</span><span class="p">)</span>

<span class="c1"># Show the array, visualised with Matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">squares</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0.]
 [0. 1.]]
</pre></div>
</div>
<img alt="_images/68263706613df0ced43f23f905ac7be8e9515872ddb6fa5b76d169a7ed40469a.png" src="_images/68263706613df0ced43f23f905ac7be8e9515872ddb6fa5b76d169a7ed40469a.png" />
</div>
</div>
<p>What happens if we resize <code class="docutils literal notranslate"><span class="pre">squares</span></code> to (10, 10)? We will use the optional Boolean <code class="docutils literal notranslate"><span class="pre">preserve_range</span></code> argument which ensures the numbers in the output image stay within the range of those we give to the function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass our `squares` array to the `ski.transform.resize()` function.</span>
<span class="n">squares_ten_by_ten</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">squares</span><span class="p">,</span>
                                          <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                          <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the resized array.</span>
<span class="n">squares_ten_by_ten</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.52, 0.56, 0.6 , 0.56, 0.52, 0.48, 0.44, 0.4 , 0.44, 0.48],
       [0.56, 0.68, 0.8 , 0.68, 0.56, 0.44, 0.32, 0.2 , 0.32, 0.44],
       [0.6 , 0.8 , 1.  , 0.8 , 0.6 , 0.4 , 0.2 , 0.  , 0.2 , 0.4 ],
       [0.56, 0.68, 0.8 , 0.68, 0.56, 0.44, 0.32, 0.2 , 0.32, 0.44],
       [0.52, 0.56, 0.6 , 0.56, 0.52, 0.48, 0.44, 0.4 , 0.44, 0.48],
       [0.48, 0.44, 0.4 , 0.44, 0.48, 0.52, 0.56, 0.6 , 0.56, 0.52],
       [0.44, 0.32, 0.2 , 0.32, 0.44, 0.56, 0.68, 0.8 , 0.68, 0.56],
       [0.4 , 0.2 , 0.  , 0.2 , 0.4 , 0.6 , 0.8 , 1.  , 0.8 , 0.6 ],
       [0.44, 0.32, 0.2 , 0.32, 0.44, 0.56, 0.68, 0.8 , 0.68, 0.56],
       [0.48, 0.44, 0.4 , 0.44, 0.48, 0.52, 0.56, 0.6 , 0.56, 0.52]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the image attributes.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (10, 10)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the image.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5552a82974c63354ff4f3c1e78654e21218e3a7adab3f07a1b56bad6ba3af663.png" src="_images/5552a82974c63354ff4f3c1e78654e21218e3a7adab3f07a1b56bad6ba3af663.png" />
</div>
</div>
<p>Well, that is certainly more artistic than the original!</p>
<p>We now have many more <code class="docutils literal notranslate"><span class="pre">unique</span></code> values in the output array than there were in the input array (the input array contained only 0’s and 1’s), because <code class="docutils literal notranslate"><span class="pre">skimage</span></code> is interpolating for many new pixels. This means that it is estimating values for the new pixels which fall in between the array pixels from the original array image, based on the a weighted average of the values of the original pixels which they are nearest to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the `unique` values.</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.2 , 0.2 , 0.2 , 0.32, 0.32, 0.32, 0.32, 0.4 , 0.4 , 0.4 ,
       0.44, 0.44, 0.48, 0.48, 0.52, 0.52, 0.56, 0.56, 0.56, 0.6 , 0.6 ,
       0.6 , 0.68, 0.68, 0.68, 0.68, 0.8 , 0.8 , 0.8 , 1.  ])
</pre></div>
</div>
</div>
</div>
<p>The array pixels highlighted in red are the original pixels from the <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code> original array:</p>
<p><img alt="" src="_images/resize_interpolation.png" /></p>
<p>All the other pixels have been added by <code class="docutils literal notranslate"><span class="pre">skimage</span></code> during the <code class="docutils literal notranslate"><span class="pre">resize</span></code>-ing process. Pixels closer to the original pixels share closer intensity values to the original pixel (meaning they are more black or more white, depending on the original pixel). Images further from the original pixels become more gray.</p>
<p>We can control the type of interpolation that <code class="docutils literal notranslate"><span class="pre">skimage</span></code> uses by changing the (somewhat cryptically named) <code class="docutils literal notranslate"><span class="pre">order</span></code> argument. Setting this to 0 will activate <a class="reference external" href="https://en.wikipedia.org/wiki/Nearest-neighbor_interpolation">nearest neighbour interpolation</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass our `squares` array to the `ski.transform.resize()` function.</span>
<span class="n">squares_ten_by_ten</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">squares</span><span class="p">,</span>
                                          <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                          <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Change the interpolation method.</span>

<span class="c1"># Show the resized array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/efa2a9221c835a3df7ae6a70f3aeb99e886c259e75073cebd2ec2befda1a4d5e.png" src="_images/efa2a9221c835a3df7ae6a70f3aeb99e886c259e75073cebd2ec2befda1a4d5e.png" />
</div>
</div>
<p>This seems much closer to what we want when we <code class="docutils literal notranslate"><span class="pre">resize</span></code> the image. However, the results of image processing are highly context-dependent, and there may be images for which the default interpolation setting works better…</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rotation">
<h1>Rotation<a class="headerlink" href="#rotation" title="Link to this heading">#</a></h1>
<p>Another common image manipulation we may want to do is to rotate an image. Should we only want to rotate by increments of 90 degrees, we can use the helpfully named <code class="docutils literal notranslate"><span class="pre">np.rot90()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the image.</span>
<span class="n">rotated_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>

<span class="c1"># Show the result.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rotated_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0.]
 [0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/7e3fe9ea6373e2cd19b5ecf9ecb96eeb4ab361a5abacca68e74eff9c944299b9.png" src="_images/7e3fe9ea6373e2cd19b5ecf9ecb96eeb4ab361a5abacca68e74eff9c944299b9.png" />
</div>
</div>
<p>We can control the number of rotations with the <code class="docutils literal notranslate"><span class="pre">k</span></code> argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the image, twice!</span>
<span class="n">rotated_i_180</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                         <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Two 90 degree rotations.</span>

<span class="c1"># Show the result.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rotated_i_180</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_180</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/a3bf0b7d8f8d5676e397abcfa9351ac75014e6608e8700bd8f5857f87a7fff24.png" src="_images/a3bf0b7d8f8d5676e397abcfa9351ac75014e6608e8700bd8f5857f87a7fff24.png" />
</div>
</div>
<p>Again, with NumPy there are many routes to the same destination, and you can see that has achieved (visually) the same result as using <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> as we saw above. Rotating in increments of 90 degrees will not change the <em>size</em> (e.g. number of pixels) in the array, however it will change the integer index location of the pixel values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the shape of the original image and both 90 degree rotated images.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">i_img</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">rotated_i</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">rotated_i_180</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_180</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8cb4b9be86197ebd9455db650339270677129b45698d3d4843f8235985343823.png" src="_images/8cb4b9be86197ebd9455db650339270677129b45698d3d4843f8235985343823.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original image and 90 degree rotations all have the same number of elements (15*8 = 120)</span>
<span class="n">i_img</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">rotated_i</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">rotated_i_180</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>The cell below demonstrates <code class="docutils literal notranslate"><span class="pre">np.flip</span></code>-ping an image, as well as <code class="docutils literal notranslate"><span class="pre">np.rot</span></code>-ating an image by 180 degrees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in `camera`</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>

<span class="c1"># Rotate, flip &#39;n&#39; plot!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;np.rot90(k=2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">camera</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;np.flip()&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/86bc73a4e925a06104e6a04dfaed8724119ac38bdde554b03809052315336f0d.png" src="_images/86bc73a4e925a06104e6a04dfaed8724119ac38bdde554b03809052315336f0d.png" />
</div>
</div>
<p>To rotate an image by more flexible increments, we need to bring in SciPy, another foundational component library of Scikit-image. The SciPy function <code class="docutils literal notranslate"><span class="pre">ndimage.rotate()</span></code> offers more flexible rotation. However, rotating by other angles will alter both the <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> of the output image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import SciPy using the conventional name (`sp`).</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># Rotate the image by 193 degrees.</span>
<span class="n">rotated_i_193</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                                  <span class="n">angle</span><span class="o">=</span><span class="mi">193</span><span class="p">)</span> <span class="c1"># Specify the rotation angle.</span>

<span class="c1"># Show the &quot;raw&quot; array.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rotated_i_193</span><span class="p">)</span>

<span class="c1"># Render the image graphically.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_193</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00
   0.00e+00  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  9.19e-02  3.28e-01  1.46e-02 -9.30e-03
   1.14e-03  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  1.19e-02 -7.40e-02  8.85e-01  1.30e+00  2.34e-01 -5.79e-02
   9.74e-03  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  2.30e-02 -9.94e-02  5.32e-01  1.16e+00  4.46e-01 -9.18e-02
   1.97e-02  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  1.33e-02 -7.05e-02  2.94e-01  1.18e+00  7.22e-01 -9.12e-02
   2.01e-02  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  3.35e-03 -2.49e-02  7.87e-02  1.06e+00  9.45e-01 -2.01e-02
   1.59e-03  3.04e-05  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.05e-02 -5.31e-02  8.77e-01  1.11e+00  1.43e-01
  -4.04e-02  6.37e-03  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.16e-02 -9.77e-02  6.31e-01  1.19e+00  3.73e-01
  -8.34e-02  1.70e-02  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  1.69e-02 -8.35e-02  3.76e-01  1.20e+00  6.38e-01
  -9.80e-02  2.14e-02  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  6.43e-03 -4.04e-02  1.40e-01  1.07e+00  8.46e-01
  -5.22e-02  1.08e-02  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  2.94e-05  1.59e-03 -2.13e-02  1.05e+00  1.21e+00
   8.46e-02 -2.23e-02  2.08e-03  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  2.07e-02 -7.40e-02  3.77e-01  2.86e-01
   1.34e-02 -6.91e-04  2.08e-03  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  2.41e-04 -3.74e-03  1.05e-01  6.11e-01
   4.42e-01 -1.04e-01  2.57e-02  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  8.91e-03 -6.26e-02  2.63e-01  1.43e+00
   9.24e-01 -7.36e-02  1.14e-02  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  1.17e-03 -9.12e-03  1.40e-02  3.06e-01
   8.45e-02  0.00e+00  0.00e+00  0.00e+00]
 [ 0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00  0.00e+00
   0.00e+00  0.00e+00  0.00e+00  0.00e+00]]
</pre></div>
</div>
<img alt="_images/c15b46825c7a1584796c6908cc45ec543d9a0d2ead0f9bdb76eee4cf9639ae49.png" src="_images/c15b46825c7a1584796c6908cc45ec543d9a0d2ead0f9bdb76eee4cf9639ae49.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the attributes of the rotated image.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">rotated_i_193</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (16, 11)
Max Pixel Value: 1.43
Min Pixel Value: -0.1
</pre></div>
</div>
</div>
</div>
<p>The cell below will loop through some different rotation angles, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of each image is shown below each plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A for loop to show multiple rotations, and the effect on</span>
<span class="c1"># the dimensionality of the resultant image array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                                    <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_rot</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a402c9dfac7c5daa911544c1c936697f1117f42d86d7337482528b276597f2cd.png" src="_images/a402c9dfac7c5daa911544c1c936697f1117f42d86d7337482528b276597f2cd.png" />
</div>
</div>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> is altered so that the original array is shown within the output array. SciPy uses interpolation to estimate the values of the pixels it adds, where the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of the output image is larger than the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of the input image.</p>
<p>We can disable this behaviour by settings <code class="docutils literal notranslate"><span class="pre">reshape=False</span></code>, however, then we risk “cutting” off aspects of what our original image depicts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A for loop to show multiple rotations, and the effect on</span>
<span class="c1"># the dimensionality of the resultant image array., but this time</span>
<span class="c1"># we do not allow SciPy to reshape the output arrays.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                                    <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">,</span>
                                    <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Do not reshape the output images.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_rot</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80b1cc80cdee270a09cf61de78b453cb1c28239257eeeb0698559b6d96d53e9f.png" src="_images/80b1cc80cdee270a09cf61de78b453cb1c28239257eeeb0698559b6d96d53e9f.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rotating-an-image-with-skimage">
<h1>Rotating an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#rotating-an-image-with-skimage" title="Link to this heading">#</a></h1>
<p>Let’s now look now at how rotating image arrays is handled in <code class="docutils literal notranslate"><span class="pre">skimage</span></code>. Image rotation, which we saw above using <code class="docutils literal notranslate"><span class="pre">np.rot90</span></code> and <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.rotate()</span></code> can be achieved using the straightforwardly named <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>, and the syntax works identically to <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.rotate()</span></code>. All this rotating has left us thirsty and caffeine-deprived, so let’s get some <code class="docutils literal notranslate"><span class="pre">coffee</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import and show an image.</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3ace24347b7b925e99bc97c1a18d888eadd605c054739fbb0aab93b14c39f1f.png" src="_images/b3ace24347b7b925e99bc97c1a18d888eadd605c054739fbb0aab93b14c39f1f.png" />
</div>
</div>
<p>We can achieve easy and flexible rotation with <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the `coffee` image with `skimage`.</span>
<span class="n">rotated_coffee</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> 
                                      <span class="n">angle</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                      <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Ensure the original image fits in side the</span>
                                                   <span class="c1"># output image.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3c6116c9a88af383cbe33215e99d686708aedebf04ca77929884a9194664df88.png" src="_images/3c6116c9a88af383cbe33215e99d686708aedebf04ca77929884a9194664df88.png" />
</div>
</div>
<p>The cell below plots a variety of rotations, using <code class="docutils literal notranslate"><span class="pre">skimage.transform.rotate()</span></code> to perform each rotation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Many rotations...</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> 
                                    <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">,</span>
                                    <span class="n">resize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Do not reshape the output images.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/827efc6d9cdba905dee5c4e20da9d513fafceb955fd94e6860ec2bd98632b903.png" src="_images/827efc6d9cdba905dee5c4e20da9d513fafceb955fd94e6860ec2bd98632b903.png" />
</div>
</div>
<p>Specifically for 90 degree rotations, you might be tempted to use a NumPy shortcut, and use the <code class="docutils literal notranslate"><span class="pre">.T</span></code> (transpose) method. This however, will do something different to rotation. The cell below demonstrates the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method, with the <code class="docutils literal notranslate"><span class="pre">camera</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose `camera`.</span>
<span class="n">camera_transposed</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">T</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;camera.T&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/e5a72ca887f8ff747575f06c90a00fcde11af20ea56e3acfd4e4180b36500566.png" src="_images/e5a72ca887f8ff747575f06c90a00fcde11af20ea56e3acfd4e4180b36500566.png" />
</div>
</div>
<p>We now show a 90 degree rotation, using <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate by 90 degrees.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> 
                                <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ski.transform.rotate()&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ffab0d27b92daa2fe7e64aa8a31260344c017d0faae9495be757ed1aefdbec31.png" src="_images/ffab0d27b92daa2fe7e64aa8a31260344c017d0faae9495be757ed1aefdbec31.png" />
</div>
</div>
<p>We can see that the cameraman is facing a different direction in each image (taking a photo of the bottom of the image for the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method, and taking a photo of the top of the image for a 90 degree rotation via <code class="docutils literal notranslate"><span class="pre">skimage</span></code>).</p>
<p>The difference here is that transposing an image switches the rows and columns, such that the first row becomes the first column etc. Conversely, <code class="docutils literal notranslate"><span class="pre">skimage.transform.rotate()</span></code> pivots the pixels around a central point. Essentially, transposing gives a <em>mirroring effect</em> which is different from a rotation.</p>
<p>Pay attention to the location of the spoon in the <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image. First, we <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code> it by 90 degrees. Then, we show it <code class="docutils literal notranslate"><span class="pre">.transpose</span></code>d, switching the rows and columns. As <code class="docutils literal notranslate"><span class="pre">coffee</span></code> is a 3D image, the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method will produce an error, because the color channels will be moved into the wrong dimension - to avoid this we use the <code class="docutils literal notranslate"><span class="pre">.transpose</span></code> method, to keep the color channels in the third dimension, whilst switching the rows and columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The `shape` of the original `coffee` image.</span>
<span class="n">coffee</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400, 600, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Why we cannot use the `.T` method. We get an array which</span>
<span class="c1"># is the wrong `shape` for a color image!</span>
<span class="n">coffee</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 600, 400)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_transposed</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># Move the columns into the rows, the rows into the columns, </span>
                                               <span class="c1"># and leave the color channels in the third dimension.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">);</span> 
 
<span class="c1"># Show the attributes (not that the `shape` is still correct for a color image).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (600, 400, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/e3939c41941a6601c6d1fc5679a33073964750df7582ae505f83027d92a84935.png" src="_images/e3939c41941a6601c6d1fc5679a33073964750df7582ae505f83027d92a84935.png" />
</div>
</div>
<p>Compare this to a 90 degree rotation via <code class="docutils literal notranslate"><span class="pre">skimage</span></code>, pay attention to the spoon!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the difference between rotating and transposing.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ski.transform.rotate()&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;.transpose()&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b5cab1d4b5a337434fa31be469ab50aded82b87d2436afe63382ddfa93c54805.png" src="_images/b5cab1d4b5a337434fa31be469ab50aded82b87d2436afe63382ddfa93c54805.png" />
</div>
</div>
<p>Unless you specifically want a mirroring transformation, then use <code class="docutils literal notranslate"><span class="pre">.rotate()</span></code>!</p>
<div class="exercise dropdown admonition" id="look-at-me">

<p class="admonition-title"><span class="caption-number">Exercise 13 </span></p>
<section id="exercise-content">
<p>Your mission now is to transform <code class="docutils literal notranslate"><span class="pre">camera</span></code> into this slightly brain-bending image:</p>
<p><img alt="" src="_images/look_at_me.png" /></p>
<p>For comparison, here is the original <code class="docutils literal notranslate"><span class="pre">camera</span></code> image and its attributes:</p>
<p><img alt="" src="_images/camera_plot.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p>Your final image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 1024)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p><em>Hint</em>: if you did not complete the earlier exercise involving combining two <code class="docutils literal notranslate"><span class="pre">i_img</span></code> arrays, then you may want to investigate NumPy functions for combining arrays together to complete the current exercise…</p>
<p><em>Caution:</em> you may run into some errors/odd outcomes because of <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s here… so use the <code class="docutils literal notranslate"><span class="pre">ski.util</span></code> conversion functions if you need to…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#look-at-me"> Exercise 13</a></p>
<section id="solution-content">
<p>Here we need a transpose operation, followed by a rotation, followed by a concatenation.</p>
<p>That is a mouthful, let’s break it down. First we transpose the <code class="docutils literal notranslate"><span class="pre">camera</span></code> array, we can use <code class="docutils literal notranslate"><span class="pre">.T</span></code> here rather than <code class="docutils literal notranslate"><span class="pre">.transpose</span></code> as we are dealing with a 2D grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose `camera`.</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">mirror_camera</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mirror_camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/db5204acaa874e27c8860c2d53ceafa6584d0742ef52315c4448799f51a8be3a.png" src="_images/db5204acaa874e27c8860c2d53ceafa6584d0742ef52315c4448799f51a8be3a.png" />
</div>
</div>
<p>Now the image is transposed, we have achieved our “mirror” effect. To get this mirrored cameraman to look the other guy in the eye, we now need to rotate the image 270 degrees, for which we use <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate and show.</span>
<span class="n">rotated_mirror_camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">mirror_camera</span><span class="p">,</span>
                                             <span class="n">angle</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span>
                                             <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Preserve the dimensions to match the original.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/61bd1fce7f7f15b642094d5695f6b53656d0bf03e15a013e176d8ce04506d773.png" src="_images/61bd1fce7f7f15b642094d5695f6b53656d0bf03e15a013e176d8ce04506d773.png" />
</div>
</div>
<p>Now, we must combine the images, using <code class="docutils literal notranslate"><span class="pre">np.concat()</span></code>, combining along the columns (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>). First, however, we need to ensure the <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s match! If we don’t we get an unexpected result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the images, non-matching `dtype`s...</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">camera</span><span class="p">,</span> <span class="n">rotated_mirror_camera</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">look_at_me</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/234b89ef2c64fac20bc3a015436a113646fcd13e10442b31e178e9008e913e35.png" src="_images/234b89ef2c64fac20bc3a015436a113646fcd13e10442b31e178e9008e913e35.png" />
</div>
</div>
<p>Oops. This has occurred because <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code> has converted the image to the <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype, whereas the original is <code class="docutils literal notranslate"><span class="pre">uint8</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The attributes of the original image (look at the `dtype`).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The attributes of the rotated mirror image (look at the `dtype`).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (512, 512)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">ski.util.img_as_ubyte()</span></code> will ensure that the pixel values match, giving us our final, surreal result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure matching `dtype`s.</span>
<span class="n">rotated_mirror_camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">)</span>

<span class="c1"># Combine the images and show the result.</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">camera</span><span class="p">,</span> <span class="n">rotated_mirror_camera</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">look_at_me</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/560fea6b37dc4a959c762eeb31f0201b145b591b35f5ef02b8084e4b03a779cc.png" src="_images/560fea6b37dc4a959c762eeb31f0201b145b591b35f5ef02b8084e4b03a779cc.png" />
</div>
</div>
<p>If in doubt, check the <code class="docutils literal notranslate"><span class="pre">dtype</span></code>!</p>
</section>
</div>
<div class="exercise dropdown admonition" id="yellow-fellow">

<p class="admonition-title"><span class="caption-number">Exercise 14 </span></p>
<section id="exercise-content">
<p>For this exercise, you should load in the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image from <code class="docutils literal notranslate"><span class="pre">ski.data</span></code>. Here is the original <code class="docutils literal notranslate"><span class="pre">cat</span></code> image:</p>
<p><img alt="" src="_images/cat.png" /></p>
<p>The original image has the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
<p>Now, using only <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">skimage</span></code>, try to recreate this target image:</p>
<p><img alt="" src="_images/poor_cat.png" /></p>
<p>…poor cat!</p>
<p>Your output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.76
Min Pixel Value: 0.0
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#yellow-fellow"> Exercise 14</a></p>
<section id="solution-content">
<p>The solution here again involves multiple steps. First we load in the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in and show the `cat` image.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/60b7cd61208645b425827f7a1ad2f07076f41c86351b79cba077558e9f2a5174.png" src="_images/60b7cd61208645b425827f7a1ad2f07076f41c86351b79cba077558e9f2a5174.png" />
</div>
</div>
<p>Next, to replicate the yellow-y tone of the target image, we “switch off” the blue color channel (because red + green = yellow):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make it yellow!</span>
<span class="n">cat_solution</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d11906762279c1803923a006690287d1e503f88e72263556d809c6ea4102f69b.png" src="_images/d11906762279c1803923a006690287d1e503f88e72263556d809c6ea4102f69b.png" />
</div>
</div>
<p>The target image has the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> (30, 30, 3); the original image has the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> (300, 451, 3).</p>
<p>To get the correct output image size, we must <em>downscale</em> the image. To do this, we can use <code class="docutils literal notranslate"><span class="pre">ski.transform.resize()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Downscale the image.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">,</span>
                                    <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1"># Show the result.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.8
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/8932cd99848a2b173db0d8fbecef867d0375fd061f96352dab08d47136256b32.png" src="_images/8932cd99848a2b173db0d8fbecef867d0375fd061f96352dab08d47136256b32.png" />
</div>
</div>
<p>You’ll notice that downsizing the image has seriously downgraded the quality. This makes sense, because the original high-resolution image utilized its many pixels to depict intricate details. After resizing to a lower-resolution, this detail is lost, because now we are trying to show the same image using subtantially fewer pixels. <code class="docutils literal notranslate"><span class="pre">skimage</span></code> has done some averaging behind the scenes, to work out what should go in the remaining pixels. At least we can still see the image is of a cat…</p>
<p>Now, we can see that the target image requires a rotation, through good judgment, or just trial and error, we can work out that this needs to be 45 degrees. We can also see that the image of the downscaled cat does not “fit” inside the final image. As such, we need to rotate <em>without resizing</em> the image. By default, <code class="docutils literal notranslate"><span class="pre">resize=False</span></code> so we can leave it on the default setting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate and show the result.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">,</span>
                                    <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.76
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/b219798e6a9741b82019e0155aa1f9cbc7a1cccc2e849485cd0ce01b202f3413.png" src="_images/b219798e6a9741b82019e0155aa1f9cbc7a1cccc2e849485cd0ce01b202f3413.png" />
</div>
</div>
<p>We will leave it to you to use this image as a logo for your “Pixel Cat” <a class="reference external" href="https://en.wikipedia.org/wiki/Meme_coin">meme coin</a>.</p>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cropping">
<h1>Cropping<a class="headerlink" href="#cropping" title="Link to this heading">#</a></h1>
<p>The process of “cropping” is the removal areas of pixels from an image.</p>
<p>Because our images are just NumPy arrays, cropping is just NumPy indexing (duh!). As such, we can crop images just with indexing operations, without using specific NumPy (or <code class="docutils literal notranslate"><span class="pre">skimage</span></code>) functions.</p>
<p>For instance, we can “shave” our <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array in half, along the columns by slicing along the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cut in half.</span>
<span class="n">half_i</span> <span class="o">=</span> <span class="n">i_img</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">half_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">half_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/aa4a0ab682557f4d5a6d2920d73093e3e3433ce5bc59306869c6b71f151bd160.png" src="_images/aa4a0ab682557f4d5a6d2920d73093e3e3433ce5bc59306869c6b71f151bd160.png" />
</div>
</div>
<p>Likewise along the rows (albeit the number of rows is odd!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="p">:]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/13fc9b1540fa01ed5928b7f981efa01fda37c60e1bf113261b8126e6c84c7504.png" src="_images/13fc9b1540fa01ed5928b7f981efa01fda37c60e1bf113261b8126e6c84c7504.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="cropped-camera">

<p class="admonition-title"><span class="caption-number">Exercise 15 </span></p>
<section id="exercise-content">
<p>Take the original <code class="docutils literal notranslate"><span class="pre">camera</span></code> image:</p>
<p><img alt="" src="_images/camera_plot.png" /></p>
<p>…and crop it down to this target image, using only NumPy indexing:</p>
<p><img alt="" src="_images/camera_cropped.png" /></p>
<p>These are the attributes which your final image should possess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (30, 80)
Max Pixel Value: 250
Min Pixel Value: 23
</pre></div>
</div>
<p><em>Hint:</em> using <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code> might be of use here…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">camera_crop_exercise</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/50aff3d36362558deba307a37ae4682958e48d2b46c8fe49483f0733bf1123b0.png" src="_images/50aff3d36362558deba307a37ae4682958e48d2b46c8fe49483f0733bf1123b0.png" />
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-9">

<p class="admonition-title">Solution to<a class="reference internal" href="#cropped-camera"> Exercise 15</a></p>
<section id="solution-content">
<p>This is a simple task once you know what indexes you need. Using <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code> can make this information easier to obtain:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show `camera`, with a helpful grid.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ac851d6694acde7918024af2f4277e856d5a8f3def28c2bea1c2f6fe5c9410fc.png" src="_images/ac851d6694acde7918024af2f4277e856d5a8f3def28c2bea1c2f6fe5c9410fc.png" />
</div>
</div>
<p>The exact indices we used are here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">[</span><span class="mi">130</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span><span class="mi">320</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0e1fab12e6671151485fa51554b754cf7c9bcde636683306f1a753d8ed0c653a.png" src="_images/0e1fab12e6671151485fa51554b754cf7c9bcde636683306f1a753d8ed0c653a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution (attributes).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">[</span><span class="mi">130</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span><span class="mi">320</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (30, 80)
Max Pixel Value: 250
Min Pixel Value: 23
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="masks">
<h1>Masks<a class="headerlink" href="#masks" title="Link to this heading">#</a></h1>
<p>In image processing, a mask is a matrix/array containing a collection of elements in a certain shape. A mask is “placed” on an image, and pixel values under the mask are all replaced with a specific value. Let’s demonstrate with a real image — a grayscale version of the standard <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coffee_gray</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">())</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">coffee_gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_gray</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (400, 600)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/dac19c1554e829ebdf2e46c41facbcef0df8303b750143bd5cda389f38533b83.png" src="_images/dac19c1554e829ebdf2e46c41facbcef0df8303b750143bd5cda389f38533b83.png" />
</div>
</div>
<p>First, we extract the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of the image, and store each element as a separate variable. In this case, the image is 2D (e.g. single-channel, monochrome) and so we extract the number of rows and the number of columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unpack and store the number of rows and number of columns.</span>
<span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span> <span class="o">=</span> <span class="n">coffee_gray</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># Show the values.</span>
<span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400, 600)
</pre></div>
</div>
</div>
</div>
<p>Then we can use these elements (400 and 600) via <code class="docutils literal notranslate"><span class="pre">np.orgid()</span></code> to create one array with 400 rows, and 1 column, and another array with 1 row and 600 columns. These elements can be used to make a 2D mask, in a specific shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grid, based on the image `shape`.</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">dim_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">dim_2</span><span class="p">]</span>

<span class="c1"># Show the `shape` of the X elements.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Show the first 10 elements of X.</span>
<span class="n">X</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400, 1)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0],
       [1],
       [2],
       [3],
       [4],
       [5],
       [6],
       [7],
       [8],
       [9]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the `shape` of the Y elements.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Show Y</span>
<span class="n">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 600)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
         13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
         26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
         39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
         52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
         65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
         78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
         91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
        104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116,
        117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129,
        130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
        143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155,
        156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168,
        169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181,
        182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
        195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207,
        208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220,
        221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233,
        234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246,
        247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259,
        260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272,
        273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285,
        286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298,
        299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311,
        312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324,
        325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337,
        338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350,
        351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363,
        364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376,
        377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389,
        390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402,
        403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415,
        416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428,
        429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441,
        442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454,
        455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467,
        468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480,
        481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493,
        494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506,
        507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519,
        520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532,
        533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545,
        546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558,
        559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571,
        572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584,
        585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597,
        598, 599]])
</pre></div>
</div>
</div>
</div>
<p>We can then use a geometric formula to generate a 2D grid of a specific shape, as in the cell below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a circulat mask.</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">dim_1</span><span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">dim_2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="n">dim_1</span> <span class="o">*</span> <span class="n">dim_2</span> <span class="o">/</span> <span class="mi">4</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: bool
Shape: (400, 600)
Max Pixel Value: True
Min Pixel Value: False
</pre></div>
</div>
<img alt="_images/665b2175bcf058937ab014eb197538a25ae346c188ebcd6471225ee44ce5f400.png" src="_images/665b2175bcf058937ab014eb197538a25ae346c188ebcd6471225ee44ce5f400.png" />
</div>
</div>
<p>Once we have our mask - which is just a Boolean array - it is just a matter of Boolean indexing to use it set all the pixel values underneath it to be equal to the same value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the mask.</span>
<span class="n">coffee_gray_masked</span> <span class="o">=</span> <span class="n">coffee_gray</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">coffee_gray_masked</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">coffee_gray_masked</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c9dd327a394da6fd6eefdc99df07f9fb61e907fb44ff7d76f459197ef1f8595.png" src="_images/2c9dd327a394da6fd6eefdc99df07f9fb61e907fb44ff7d76f459197ef1f8595.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="masked-man">

<p class="admonition-title"><span class="caption-number">Exercise 16 </span></p>
<section id="exercise-content">
<p>Your mission now is to use a mask, similar to the one we have just seen, to transform <code class="docutils literal notranslate"><span class="pre">camera</span></code> into the following image:</p>
<p><img alt="" src="_images/masked_camera.png" /></p>
<p>This is easier than you think…you can use the formula for the last mask as a guide. Try running the function <code class="docutils literal notranslate"><span class="pre">hint_cryptic_camera()</span></code> for a hint if you get stuck…</p>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-11">

<p class="admonition-title">Solution to<a class="reference internal" href="#masked-man"> Exercise 16</a></p>
<section id="solution-content">
<p>The circular mask we used above was generated via the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">(X</span> <span class="pre">-</span> <span class="pre">dim_1/</span> <span class="pre">2)</span> <span class="pre">**</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">(Y</span> <span class="pre">-</span> <span class="pre">dim_2</span> <span class="pre">/</span> <span class="pre">2)</span> <span class="pre">**</span> <span class="pre">2</span> <span class="pre">&gt;</span> <span class="pre">dim_1</span> <span class="pre">*</span> <span class="pre">dim_2</span> <span class="pre">/</span> <span class="pre">4</span></code></p>
<p>To obtain the mask you need for this exercise, we simply change the square exponents (<code class="docutils literal notranslate"><span class="pre">**2</span></code>) to cubes (<code class="docutils literal notranslate"><span class="pre">**3</span></code>), altering the geometry of the mask:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 1.</span>
<span class="n">dim_1</span><span class="p">,</span> <span class="n">dim_2</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">shape</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">dim_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">dim_2</span><span class="p">]</span>
<span class="n">mask_solution</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">dim_1</span><span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">dim_2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="n">dim_1</span> <span class="o">*</span> <span class="n">dim_2</span> <span class="o">/</span> <span class="mi">4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8136b575becda3f7e3ce3db38b4ccb6d08529f359aa0488c93fa00af1bbb13f0.png" src="_images/8136b575becda3f7e3ce3db38b4ccb6d08529f359aa0488c93fa00af1bbb13f0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 2.</span>
<span class="n">camera_masked_solution</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">camera_masked_solution</span><span class="p">[</span><span class="n">mask_solution</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera_masked_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/acd9e8c96386077eb099844ae3e3b09d2a572c31b8c2c28545b8f78a3cd08ab0.png" src="_images/acd9e8c96386077eb099844ae3e3b09d2a572c31b8c2c28545b8f78a3cd08ab0.png" />
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inverting-image-colors">
<h1>Inverting image colors<a class="headerlink" href="#inverting-image-colors" title="Link to this heading">#</a></h1>
<p>We saw <em>color inversion</em> on an <a class="reference internal" href="0_images_as_numpy_arrays.html"><span class="doc std std-doc">earlier page</span></a>. This is where all the pixel values in an image are, shockingly, inverted: high numbers become low numbers and vice versa:</p>
<p>For a binary image, this involves swapping 1s and 0s…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original image</span>
<span class="nb">print</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]
</pre></div>
</div>
<img alt="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" src="_images/00276c186d6468048c46b1de777f9860cb05303d82b9f813288beafc86eda109.png" />
</div>
</div>
<p>…which can be accomplished with some simple numeric operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inverted_i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_img</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inverted_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1.]]
</pre></div>
</div>
<img alt="_images/9dd205a7c7fba11b4c9a1d0bfbd5a0fc50e5f545c8a41c0bd615430bacb18d7b.png" src="_images/9dd205a7c7fba11b4c9a1d0bfbd5a0fc50e5f545c8a41c0bd615430bacb18d7b.png" />
</div>
</div>
<p>What about a color image?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in a color image.</span>
<span class="n">colorwheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;images/colorwheel.png&quot;</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/47f051e43f314d35f26f2b6497a1673c1cc0ba20e4f6bd0a27f0cd36068d260f.png" src="_images/47f051e43f314d35f26f2b6497a1673c1cc0ba20e4f6bd0a27f0cd36068d260f.png" />
</div>
</div>
<p>The numerical trick that we used with the binary image will not work for a color image like this, because the pixel values range from 0 to 255. -255 is not allowed within the acceptable range for <code class="docutils literal notranslate"><span class="pre">uint8</span></code> image data and will produce an error!</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shortcut will not work for color images</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colorwheel</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OverflowError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">70</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Shortcut will not work for color images</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colorwheel</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">OverflowError</span>: Python integer -1 out of bounds for uint8
</pre></div>
</div>
</div>
</div>
<p>But remember that inversion means we, well, “invert” the pixel values. Because the maximum value is now 255, we can subtract each array pixel value in each color channel from 255 to “reverse” the values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Invert the color image, manually.</span>
<span class="n">inverted_colorwheel</span> <span class="o">=</span> <span class="n">colorwheel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">inverted_colorwheel</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="n">inverted_colorwheel</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> 
    
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_colorwheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/500986dda188df6507e72ab295c4cb19caa9b9f19550bcd2e767c6961042b2c9.png" src="_images/500986dda188df6507e72ab295c4cb19caa9b9f19550bcd2e767c6961042b2c9.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inverting-colors-with-skimage">
<h1>Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#inverting-colors-with-skimage" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> handles color inversion, we simply pass it a color NumPy image array and voilà!:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Invert the color image, with `skimage`.</span>
<span class="n">invert_colorwheel_with_skimage</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">invert_colorwheel_with_skimage</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/500986dda188df6507e72ab295c4cb19caa9b9f19550bcd2e767c6961042b2c9.png" src="_images/500986dda188df6507e72ab295c4cb19caa9b9f19550bcd2e767c6961042b2c9.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="inv-brick">

<p class="admonition-title"><span class="caption-number">Exercise 17 </span></p>
<section id="exercise-content">
<p>Now over to you. Your task here is to load the <code class="docutils literal notranslate"><span class="pre">brick</span></code> image from <code class="docutils literal notranslate"><span class="pre">ski.data.image</span></code>.</p>
<p>You should then invert every 2nd element on even numbered rows…</p>
<p>So on <em>even</em> numbered rows (row 0, 2, 4, 6, etc.), if you went through the elements in pairs along the row, the <em>second</em> element in each pair should be inverted, vs the original image.</p>
<p>The original <code class="docutils literal notranslate"><span class="pre">brick</span></code> image looks like this:</p>
<p><img alt="" src="_images/bricks.png" /></p>
<p>The original image has the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 63 
</pre></div>
</div>
<p>Your final image should look like this:</p>
<p><img alt="" src="_images/inverted_bricks.png" /></p>
<p>Your new image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 48 
</pre></div>
</div>
<p>Use only NumPy indexing and Scikit-image functions to do this…</p>
<p><em>Hint:</em> remember that smaller NumPy arrays indexed out of larger NumPy arrays are still NumPy arrays, and so can be passed as arguments to most <code class="docutils literal notranslate"><span class="pre">skimage</span></code> functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-13">

<p class="admonition-title">Solution to<a class="reference internal" href="#inv-brick"> Exercise 17</a></p>
<section id="solution-content">
<p>The solution here is just to use slicing to select the elements we need, and <code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> just these elements, using array indexing.</p>
<p>To get every 2nd element on even numbered rows, we can use <code class="docutils literal notranslate"><span class="pre">brick[0::2,</span> <span class="pre">1::2]</span></code>.</p>
<p>This is easier to appreciate in a smaller array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">small_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get every second element, on even numbered rows.</span>
<span class="n">small_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">small_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the small array (0 elements are now gray).</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">small_arr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bfcd93f13ebc9dad357f7b72dce2f9ecde0a3b952f7e6858ace95ba303c7f40f.png" src="_images/bfcd93f13ebc9dad357f7b72dce2f9ecde0a3b952f7e6858ace95ba303c7f40f.png" />
</div>
</div>
<p>We can invert just the pixel values at these locations, by passing the slices to <code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">brick_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">brick</span><span class="p">()</span>

<span class="n">brick_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

<span class="n">show_attributes</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 48
</pre></div>
</div>
<img alt="_images/e5b3779ea0ca6b1c320eb1b621f9809ab6b2ba1fcb675e0f4ea1d838b900aea1.png" src="_images/e5b3779ea0ca6b1c320eb1b621f9809ab6b2ba1fcb675e0f4ea1d838b900aea1.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="inverted-purple">

<p class="admonition-title"><span class="caption-number">Exercise 18 </span></p>
<section id="exercise-content">
<p>Again using the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image, try to recreate the following target image, using only <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">skimage</span></code>:</p>
<p><img alt="" src="_images/purple_inverted_cat.png" /></p>
<p>Your output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 255
Min Pixel Value: 24
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat</span><span class="p">);</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/60b7cd61208645b425827f7a1ad2f07076f41c86351b79cba077558e9f2a5174.png" src="_images/60b7cd61208645b425827f7a1ad2f07076f41c86351b79cba077558e9f2a5174.png" />
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-15">

<p class="admonition-title">Solution to<a class="reference internal" href="#inverted-purple"> Exercise 18</a></p>
<section id="solution-content">
<p>The target image <em>cannot</em> be created using just <code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> on the whole <code class="docutils literal notranslate"><span class="pre">cat</span></code> image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_solution_2</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cat_solution_2</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/508debb1d46c5b760b3576409747b1b642969cd0f45a900f0daacb187f73debf.png" src="_images/508debb1d46c5b760b3576409747b1b642969cd0f45a900f0daacb187f73debf.png" />
</div>
</div>
<p>This looks cool - if anything <em>cooler</em> than the target image - but it is not what we want.</p>
<p>To recreate the target image, we must “switch” off the green color channel <em>before</em> we invert the colors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_purple</span> <span class="o">=</span> <span class="n">cat_solution_2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cat_purple</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_purple</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a6b58ce690c9a27d498f0044cf32cacb3f204e686bdfb10ae141d4cc2c273bc8.png" src="_images/a6b58ce690c9a27d498f0044cf32cacb3f204e686bdfb10ae141d4cc2c273bc8.png" />
</div>
</div>
<p>Now, when we invert the purple <code class="docutils literal notranslate"><span class="pre">cat</span></code> image, we get the target image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cat_purple</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bef9d675f96e7306487274a9ce21bdb89f9593db4b4ee37f0576a945c6403edc.png" src="_images/bef9d675f96e7306487274a9ce21bdb89f9593db4b4ee37f0576a945c6403edc.png" />
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="greyscale-to-binary-conversion">
<h1>Greyscale to binary conversion<a class="headerlink" href="#greyscale-to-binary-conversion" title="Link to this heading">#</a></h1>
<p>Greyscale to binary conversion can be achieved using comparison operators (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>). The resulting Boolean array will always be binary.</p>
<p>Let’s demonstrate with a grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grayscale image.</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">random_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">random_check</span><span class="p">[</span><span class="n">random_check</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                    <span class="n">high</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                                                    <span class="n">size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">random_check</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">random_check</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ad64682fe0941a195c8446e3c786aa37c7572042e9d5949107a9c408ca5f9099.png" src="_images/ad64682fe0941a195c8446e3c786aa37c7572042e9d5949107a9c408ca5f9099.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to a binary image:</span>
<span class="n">binary_check</span> <span class="o">=</span> <span class="n">random_check</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">random_check</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">binary_check</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">binary_check</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ True False  True False]
 [False  True False  True]
 [ True False  True False]
 [False  True False  True]]
</pre></div>
</div>
<img alt="_images/0745f771d52673676f6c100f1e25224f7891505304c30abee63ddf37734113a1.png" src="_images/0745f771d52673676f6c100f1e25224f7891505304c30abee63ddf37734113a1.png" />
</div>
</div>
<p>We can also easily achieve this conversion in <code class="docutils literal notranslate"><span class="pre">skimage</span></code> - see the <a class="reference internal" href="5_mean_filter.html"><span class="doc std std-doc">filtering page</span></a> for more detail. For now, we can use the <code class="docutils literal notranslate"><span class="pre">ski.filters.threshold_minimum()</span></code> function. This supplies us a recommended threshold value to attempt to divide the array pixels into two classes e.g. two classes where the pixels in each class are maximally different from pixels in the other class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a recommended threshold from `skimage`.</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">threshold_minimum</span><span class="p">(</span><span class="n">random_check</span><span class="p">)</span>
<span class="n">threshold</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(2)
</pre></div>
</div>
</div>
</div>
<p>We can then use this threshold to create a binary array, successfully binarizing our grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Binarize the array, based on the threshold.</span>
<span class="n">binary_check_from_ski</span> <span class="o">=</span> <span class="n">random_check</span> <span class="o">&gt;</span> <span class="n">threshold</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">binary_check_from_ski</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">binary_check_from_ski</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: bool
Shape: (4, 4)
Max Pixel Value: True
Min Pixel Value: False
</pre></div>
</div>
<img alt="_images/0745f771d52673676f6c100f1e25224f7891505304c30abee63ddf37734113a1.png" src="_images/0745f771d52673676f6c100f1e25224f7891505304c30abee63ddf37734113a1.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="color-to-grayscale-conversion">
<h1>Color to grayscale conversion<a class="headerlink" href="#color-to-grayscale-conversion" title="Link to this heading">#</a></h1>
<p>To downgrade a color image to grayscale we can use a brute force method of taking the mean of the three color channels, to produce a 2D monochrome image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">,</span> 
                     <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a47611b3f427dfafaa0343c8778903e2e67b35ccfd50f4e90aa7a00865e9d902.png" src="_images/a47611b3f427dfafaa0343c8778903e2e67b35ccfd50f4e90aa7a00865e9d902.png" />
</div>
</div>
<p>A better option here, that we encountered on the <a class="reference internal" href="2_skimage_intro.html"><span class="doc std std-doc">previous page</span></a>, is to use the <em>luminance formula</em>:</p>
<div class="math notranslate nohighlight">
\[
Y = 0.2126R + 0.7152G + 0.0722B
\]</div>
<p>This “collapses” a 3D color image into a 2D grayscale image via a weighted sum of the channels.</p>
<div class="exercise dropdown admonition" id="gray-wheel">

<p class="admonition-title"><span class="caption-number">Exercise 19 </span></p>
<section id="exercise-content">
<p>Here is the original <code class="docutils literal notranslate"><span class="pre">colorwheel</span></code> image:</p>
<p><img alt="" src="_images/colorwheel.png" /></p>
<p>It has the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p>Using the luminance formula, and any other required <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code> or <code class="docutils literal notranslate"><span class="pre">skimage</span></code> operations, recreate the target image below, starting from the <code class="docutils literal notranslate"><span class="pre">colorwheel</span></code> array:</p>
<p><img alt="" src="_images/gray_wheel.png" /></p>
<p>Your final image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p>Try to use <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> rather than slicing, when you complete this exercise.</p>
<p><em>Hint</em>: you may need to rescale the intensity values to match the target image attributes. You may recall there is a <code class="docutils literal notranslate"><span class="pre">ski.exposure</span></code> function which can help you do this…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-17">

<p class="admonition-title">Solution to<a class="reference internal" href="#gray-wheel"> Exercise 19</a></p>
<section id="solution-content">
<p>The solution here requires some close attention to <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. To apply the luminance formula using <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> is pretty straightforward:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 1.</span>

<span class="c1"># Luminance formula coefficients</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2126</span><span class="p">,</span> <span class="mf">0.7152</span><span class="p">,</span> <span class="mf">0.0722</span><span class="p">])</span>

<span class="c1"># Run the numbers...</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>

<span class="c1"># Show the result.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 255.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/a48128e5c9afa2678a8d989893bba29c657366a93979c8053a8f5620878fcba4.png" src="_images/a48128e5c9afa2678a8d989893bba29c657366a93979c8053a8f5620878fcba4.png" />
</div>
</div>
<p>But this gives us min/max pixel intensity values which are illegal for the <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype, and will generate an error when we try to convert to <code class="docutils literal notranslate"><span class="pre">uint8</span></code> to match the target image:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ouch!</span>
<span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">89</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Ouch!</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/skimage/util/dtype.py:576,</span> in <span class="ni">img_as_ubyte</span><span class="nt">(image, force_copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span> <span class="k">def</span><span class="w"> </span><span class="nf">img_as_ubyte</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">force_copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Convert an image to 8-bit unsigned integer format.</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">558</span><span class="sd">     Parameters</span>
<span class="sd">   (...)    574 </span>
<span class="g g-Whitespace">    </span><span class="mi">575</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">576</span>     <span class="k">return</span> <span class="n">_convert</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">force_copy</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/skimage/util/dtype.py:312,</span> in <span class="ni">_convert</span><span class="nt">(image, dtype, force_copy, uniform)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype_out</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">312</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Images of type float must be between -1 and 1.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span> <span class="c1"># floating point -&gt; integer</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span> <span class="c1"># use float type that can represent output integer type</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span> <span class="n">computation_type</span> <span class="o">=</span> <span class="n">_dtype_itemsize</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>     <span class="n">itemsize_out</span><span class="p">,</span> <span class="n">dtype_in</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span> <span class="p">)</span>

<span class="ne">ValueError</span>: Images of type float must be between -1 and 1.
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ski.exposure.rescale_intensity()</span></code> function can save us again here. First, we make the values legal for a <code class="docutils literal notranslate"><span class="pre">float64</span></code> image (<code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> left us with float values, as the weights in the luminance formula are decimal numbers):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rescale the pixel intensity values into a legal range, for the current `dtype`.</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">rescale_intensity</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">,</span>
                              <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>Now, we can painlessly convert to <code class="docutils literal notranslate"><span class="pre">uint8</span></code>. Finally, to match the target image, we must <code class="docutils literal notranslate"><span class="pre">ski.transform.invert()</span></code> our depressingly dreary colorwheel:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to `uint8` `dtype`.</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>

<span class="c1"># Invert the color and show the result.</span>
<span class="n">gray_wheel</span> <span class="o">=</span>  <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/56a37945a10034f300442ea064bae46c13cc48af240b36a2180a72942af5d1ef.png" src="_images/56a37945a10034f300442ea064bae46c13cc48af240b36a2180a72942af5d1ef.png" />
</div>
</div>
</section>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="color-to-grayscale-conversion-with-skimage">
<h1>Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#color-to-grayscale-conversion-with-skimage" title="Link to this heading">#</a></h1>
<p>As always, the <code class="docutils literal notranslate"><span class="pre">ski.color</span></code> module has us covered here with the <code class="docutils literal notranslate"><span class="pre">rgb2gray()</span></code> function. We simply pass it the color array that we want to convert to grayscale, without the direct need for the luminance formula:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert color to grayscale.</span>
<span class="n">gray_colorwheel_from_ski</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_colorwheel_from_ski</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_colorwheel_from_ski</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/8cc43efce7882d19f7d256ad5ed8a9f1d463513ce4dd17f903bc36c906a9a655.png" src="_images/8cc43efce7882d19f7d256ad5ed8a9f1d463513ce4dd17f903bc36c906a9a655.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h1>
<p>This page has shown how to implement some fundamental image processing operations with NumPy, SciPy and Scikit-image. The next page will delve into <a class="reference internal" href="5_mean_filter.html"><span class="doc std std-doc">image filtering</span></a>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<p>Reference: <a class="reference external" href="https://www.kdnuggets.com/numpy-for-image-processing">https://www.kdnuggets.com/numpy-for-image-processing</a></p>
<p>Reference: skimage tutorials (check versions), scipy lecture notes</p>
<p>Adapted from: <a class="reference external" href="https://lectures.scientific-python.org/advanced/image_processing">https://lectures.scientific-python.org/advanced/image_processing</a></p>
<p>Adapted from: <a class="reference external" href="https://lectures.scientific-python.org/packages/scikit-image/index.html">https://lectures.scientific-python.org/packages/scikit-image/index.html</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2_skimage_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introducing Scikit-image</p>
      </div>
    </a>
    <a class="right-next"
       href="4_threshold_filters.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Threshold filtering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">(Sci-kit) Image processing, via NumPy and SciPy</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image">Resizing an image</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image-with-skimage">Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation">Rotation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-an-image-with-skimage">Rotating an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cropping">Cropping</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-image-colors">Inverting image colors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-colors-with-skimage">Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#greyscale-to-binary-conversion">Greyscale to binary conversion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion">Color to grayscale conversion</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-skimage">Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Rush, Matthew Brett
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>