
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>(Scikit-) Image processing, via NumPy and SciPy &#8212; Scikit-image via NumPy and SciPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3_skimage_processing_from_numpy_and_scipy';</script>
    <link rel="canonical" href="https://pxr687.github.io/skimage-tutorials-temp/3_skimage_processing_from_numpy_and_scipy.html" />
    <link rel="icon" href="_static/pandas_numpy.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Threshold filtering" href="4_threshold_filters.html" />
    <link rel="prev" title="Introducing Scikit-image" href="2_skimage_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/colorwheel.png" class="logo__image only-light" alt="Scikit-image via NumPy and SciPy - Home"/>
    <script>document.write(`<img src="_static/colorwheel.png" class="logo__image only-dark" alt="Scikit-image via NumPy and SciPy - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Scikit-image via NumPy and SciPy</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_images_as_numpy_arrays.html">Images as NumPy arrays</a></li>

<li class="toctree-l1"><a class="reference internal" href="1_color_images_as_numpy_arrays.html">What about color?</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_skimage_intro.html">Introducing Scikit-image</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">(Scikit-) Image processing, via NumPy and SciPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_threshold_filters.html">Threshold filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_mean_filter.html">Filtering with kernels - the mean filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_gaussian_sharpening_edge.html">Filtering with kernels II - Gaussian blur, sharpening and edge detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_median_nonlocal_filters.html">More filters: the median filter and non-local filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_morphology.html">Morphology</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="interact/lab/index.html?path=3_skimage_processing_from_numpy_and_scipy.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch via JupyterLite"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterLite logo" src="_static/images/logo_jupyterlite.svg">
  </span>
<span class="btn__text-container">JupyterLite</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/edit/main/3_skimage_processing_from_numpy_and_scipy.Rmd" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pxr687/skimage-tutorials-temp/issues/new?title=Issue%20on%20page%20%2F3_skimage_processing_from_numpy_and_scipy.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3_skimage_processing_from_numpy_and_scipy.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>(Scikit-) Image processing, via NumPy and SciPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-by-repeating">Resizing by repeating</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image-with-skimage">Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation">Rotation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotations-in-90-degree-increments">Rotations in 90 degree increments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotations-by-arbitrary-angles-with-scipy">Rotations by arbitrary angles with Scipy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-with-skimage">Rotating with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation-compared-to-flips-and-transpos">Rotation compared to flips and transpos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cropping">Cropping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-image-colors-with-numpy">Inverting image colors with Numpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-colors-with-skimage">Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#greyscale-to-binary-conversion">Greyscale to binary conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-numpy">Color to grayscale conversion with Numpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-skimage">Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="scikit-image-processing-via-numpy-and-scipy">
<h1>(Scikit-) Image processing, via NumPy and SciPy<a class="headerlink" href="#scikit-image-processing-via-numpy-and-scipy" title="Link to this heading">#</a></h1>
<p>This page will explore foundational image processing techniques, as operations
on the values in a NumPy image array. First, we will explore how to achieve
specific effects using NumPy and SciPy. We will demonstrate what these
operations are doing to an image at the level of the array pixels. After that,
we will show how more sophisticated extensions of these techniques can be
implemented with Scikit-image. We will focus on the way that Scikit-image
often uses NumPy and SciPy operations “under the hood”.</p>
<p><a class="reference internal" href="0_images_as_numpy_arrays.html#ip-maxim"><span class="std std-ref">Remember that</span></a> <em>“image processing” is when we do something that
analyzes or changes the numbers inside the image array</em>? Well, in fact, all
that even the fanciest image processing software is doing is changing the
pixel values inside image arrays, in various ways. This is true for image
processing software with a graphical user interface, like <a class="reference external" href="https://www.adobe.com/th_en/products/photoshop">Adobe
Photoshop</a> and <a class="reference external" href="https://www.gimp.org">the GNU Image
Manipulation Program</a>, as well as for code-based image
processing software like Scikit-image.</p>
<p>Let’s again build a simple image array, and look at the ways we can use NumPy alone to achieve some pretty radical changes to the original image. We will then look at the specific purposes that such changes are used for, with more complex images.</p>
<p>First, we create do our usual imports, and create our image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ski</span>

<span class="c1"># Set precision for float numbers</span>
<span class="o">%</span><span class="k">precision</span> 2

<span class="c1"># Set &#39;gray&#39; as the default colormap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span>

<span class="c1"># Import hints for some exercises, and custom function for showing image</span>
<span class="c1"># attributes.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skitut</span><span class="w"> </span><span class="kn">import</span> <span class="n">hints</span><span class="p">,</span> <span class="n">show_attributes</span>

<span class="c1"># Create our image array.</span>
<span class="n">i_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                  <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Show the image array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" src="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" />
</div>
</div>
<p>We have <a class="reference internal" href="0_images_as_numpy_arrays.html#np-flip"><span class="std std-ref">already encountered</span></a> the use of <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> as a tool for
rudimentary image manipulation. We use it to, well, flip an image array on its
head:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flip the array.</span>
<span class="n">flipped_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; array pixel values.</span>
<span class="n">flipped_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the array with Matplotlib.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">flipped_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/209add903c33efd7aa20bfa370c7f14595adb25270945d89cd43948cd77a2740.png" src="_images/209add903c33efd7aa20bfa370c7f14595adb25270945d89cd43948cd77a2740.png" />
</div>
</div>
<section id="resizing-by-repeating">
<h2>Resizing by repeating<a class="headerlink" href="#resizing-by-repeating" title="Link to this heading">#</a></h2>
<p>Now, <em>any operation that changes the numbers in the array</em> is a form of image manipulation. The term <em>image processing</em> generally means we are applying image manipulations <em>to achieve a specific purpose</em> - such as improving image quality or clarity.</p>
<p>Let’s say we want to <em>resize</em> our image array. Using NumPy, there are many
ways to this same destination. Provided we want to <em>double</em> (or triple, or
quadruple) the size along a given dimension, we can achieve what we want using
<code class="docutils literal notranslate"><span class="pre">np.repeat()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double the image, by repeating each row.</span>
<span class="n">doubled_i_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                           <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; array pixel values.</span>
<span class="n">doubled_i_rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the array with Matplotlib.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i_rows</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ecdc223ae9a06603c4bf5947849d794ca65b3c8f0ce739a3c74c862eed290d4b.png" src="_images/ecdc223ae9a06603c4bf5947849d794ca65b3c8f0ce739a3c74c862eed290d4b.png" />
</div>
</div>
<p>We can compare the attributes, including the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of each array, using a custom function we defined in the first cell of this notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">doubled_i_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>We can see that we have twice the number of rows in the <code class="docutils literal notranslate"><span class="pre">doubled_i_rows</span></code> image.</p>
<p>We can also double along the columns, by setting <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double along the columns.</span>
<span class="n">doubled_i_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                           <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">doubled_i_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i_cols</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a321a3b41957cba07cac178cc7bcb8eb8859bf2d25170f8848d683e4c1ce7152.png" src="_images/a321a3b41957cba07cac178cc7bcb8eb8859bf2d25170f8848d683e4c1ce7152.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Indeed, the columns have doubled.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">doubled_i_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 16)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>By combining these operations, we can double along both the rows and the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Double the whole image.</span>
<span class="n">doubled_i</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                       <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">double_doubled_i</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">,</span>
                              <span class="n">repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">double_doubled_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">doubled_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ecdc223ae9a06603c4bf5947849d794ca65b3c8f0ce739a3c74c862eed290d4b.png" src="_images/ecdc223ae9a06603c4bf5947849d794ca65b3c8f0ce739a3c74c862eed290d4b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The original image size was (15, 8).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">double_doubled_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 16)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="exercise dropdown admonition" id="i-!">

<p class="admonition-title"><span class="caption-number">Exercise 11 </span></p>
<section id="exercise-content">
<p>Use NumPy operations <em>only</em> to create the following image array, using the
<code class="docutils literal notranslate"><span class="pre">i_img</span></code> array as your starting point:</p>
<p><img alt="" src="_images/eye-%21.png" /></p>
<p>Your final array should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<p><em>Hint</em>: you may want to investigate NumPy functions for combining arrays</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i_exclam</span> <span class="o">=</span> <span class="n">i_img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#i-!"> Exercise 11</a></p>
<section id="solution-content">
<p>You can do this in one line of code by using a combination of <code class="docutils literal notranslate"><span class="pre">np.concat()</span></code>, <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code>. Notably,<code class="docutils literal notranslate"><span class="pre">np.concat()</span></code> will “stick” (concatenate) arrays together, rather than <code class="docutils literal notranslate"><span class="pre">np.repeat()</span></code>-ing the values…</p>
<p>Combined with <code class="docutils literal notranslate"><span class="pre">np.flip()</span></code> we can produce the desired result in one line of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the two `i_img` arrays, flip the second.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">i_img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">i_img</span><span class="p">)]));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/89f1b41ae46927713fdc46e31adcfd1ed7c0ab38fbde611fd8a595fc499fae15.png" src="_images/89f1b41ae46927713fdc46e31adcfd1ed7c0ab38fbde611fd8a595fc499fae15.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="split-i">

<p class="admonition-title"><span class="caption-number">Exercise 12 </span></p>
<section id="exercise-content">
<p>Here again is the <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array, and a printout of its attributes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 8)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" src="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" />
</div>
</div>
<p>Your task is to find a way, again using only NumPy, to alter the <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array so it becomes this target image:</p>
<p><img alt="" src="_images/split_i.png" /></p>
<p>The output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (15, 7)
Max Pixel Value: 1.0
Min Pixel Value: -1.0
</pre></div>
</div>
<p><em>Note</em>: notice how we have lost a column, relative to the original <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array…  We also now have -1 values in the array. Have a think about which colors in the displayed image you think that these negative values will correspond to.</p>
<p><em>Hint:</em> there are various ways to do this, but the most efficient way we could think of is one short line of Numpy processing.  You might consider having a look at <a class="reference external" href="https://inferentialthinking.com/chapters/05/1/Arrays.html#functions-on-arrays">Functions on arrays</a> for inspiration.</p>
<p><em>Hint:</em> run the function <code class="docutils literal notranslate"><span class="pre">hints.split_i()</span></code>, which was imported at the beginning
of this notebook, to see a helpful hint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">split_i</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-3">

<p class="admonition-title">Solution to<a class="reference internal" href="#split-i"> Exercise 12</a></p>
<section id="solution-content">
<p>The target image can be created using the <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> function, which calculates the difference between adjacent values in an array. By default <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> operates in steps of 1 across the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between values along the columns, in steps of 1.</span>
<span class="n">split_i_solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>

<span class="c1"># Show the &quot;raw&quot; NumPy array.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">split_i_solution</span><span class="p">)</span>

<span class="c1"># Display the image.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">split_i_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]]
</pre></div>
</div>
<img alt="_images/1fda69c491389043f1e3da1f976816e5e32fc3394dfc9c272a52af0ffa1d9da6.png" src="_images/1fda69c491389043f1e3da1f976816e5e32fc3394dfc9c272a52af0ffa1d9da6.png" />
</div>
</div>
<p>Why is the background now gray? Well, <a class="reference internal" href="1_color_images_as_numpy_arrays.html#color-and-matplotlib"><span class="std std-ref">remember that</span></a>,
for a single-channel image, colors arise from applying the current colormap.
Visualised with the <code class="docutils literal notranslate"><span class="pre">gray</span></code> colormap: the most intense (highest value) pixels
are white, and the least intense (lowest value) pixels are black, and
intermediate values are a shade of gray.</p>
<p>When we subtract along the column, with <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> the third value is subtracted from the fourth value etc., and so the resulting differences are calculated as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">1</span></code> for 1 values on the left-hand side of the original image, and…</p></li>
<li><p>…<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">-1</span></code> for 1 values on the right-hand side of the original image…</p></li>
<li><p>…and <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">0</span></code> for adjacent 1’s; <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code> for adjacent 0’s.</p></li>
</ul>
<p>Essentially we are detecting <em>edges</em> (big changes in intensity between adjacent pixels) in the horizontal direction (e.g. within each row, along the columns):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show before/after applying `np.diff()` to the image array.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Before:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">i_img</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">After:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">split_i_solution</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before:
 [[0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 1. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0.]]

After:
 [[ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  1.  0. -1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.]]
</pre></div>
</div>
</div>
</div>
<p>So our highest values are now 1, our lowest values are -1, and our intermediate values are 0 (e.g. where the difference between elements was calculated from <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">-</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code>, indicating no change in the <em>gradient</em> of pixel intensity). A range from -1 to 1 is still supported in <code class="docutils literal notranslate"><span class="pre">skimage</span></code> for the <code class="docutils literal notranslate"><span class="pre">float64</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
<p>White areas (pixel = 1) indicate a change between pixels in the horizontal direction (moving left-to-right) from black-to-white, in the original image. Black areas (pixel = -1) indicate a change in the horizontal direction from white-to-black. Grey areas indicate no change (pixel = 0).</p>
<p>We can detect big changes (edges) in the <em>vertical</em> direction by telling <code class="docutils literal notranslate"><span class="pre">np.diff()</span></code> to operate along the rows, rather than along the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertical_gradients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                             <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Subtract along the rows, not the columns.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vertical_gradients</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/66e99086e79991cf258b69bab0223484ba3b77d4ccac5529339b3eb5807013fa.png" src="_images/66e99086e79991cf258b69bab0223484ba3b77d4ccac5529339b3eb5807013fa.png" />
</div>
</div>
</section>
</div>
</section>
<section id="resizing-an-image-with-skimage">
<h2>Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#resizing-an-image-with-skimage" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ski.transform</span></code> module contains a function called <code class="docutils literal notranslate"><span class="pre">resize</span></code>.  Somewhat
obviously, <code class="docutils literal notranslate"><span class="pre">ski.transform.resize()</span></code> takes an input image and a requested image
shape, and returns an output image of the requested size.  Because all
computer images are at least 2D arrays, this involves changing the shape of
the image. Let’s demonstrate this with the following image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an image array.</span>
<span class="n">squares</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,]],</span>
                   <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Show the array (&quot;raw&quot; output from NumPy)</span>
<span class="n">squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the array, visualised with Matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">squares</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/537da698d538dc2e027b8fef4e66635a37eb47d3d8fe0b431d863547b3f90def.png" src="_images/537da698d538dc2e027b8fef4e66635a37eb47d3d8fe0b431d863547b3f90def.png" />
</div>
</div>
<p>What happens if we resize <code class="docutils literal notranslate"><span class="pre">squares</span></code> to (10, 10)? We will use the optional Boolean <code class="docutils literal notranslate"><span class="pre">preserve_range</span></code> argument for forward compatibility with the next big release of the Scikit-image package.  It has the effect of preventing some automatic processing of the range of values in the image array on input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass our `squares` array to the `ski.transform.resize()` function.</span>
<span class="n">squares_ten_by_ten</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">squares</span><span class="p">,</span>
                                          <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                          <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the resized array.</span>
<span class="n">squares_ten_by_ten</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.52, 0.56, 0.6 , 0.56, 0.52, 0.48, 0.44, 0.4 , 0.44, 0.48],
       [0.56, 0.68, 0.8 , 0.68, 0.56, 0.44, 0.32, 0.2 , 0.32, 0.44],
       [0.6 , 0.8 , 1.  , 0.8 , 0.6 , 0.4 , 0.2 , 0.  , 0.2 , 0.4 ],
       [0.56, 0.68, 0.8 , 0.68, 0.56, 0.44, 0.32, 0.2 , 0.32, 0.44],
       [0.52, 0.56, 0.6 , 0.56, 0.52, 0.48, 0.44, 0.4 , 0.44, 0.48],
       [0.48, 0.44, 0.4 , 0.44, 0.48, 0.52, 0.56, 0.6 , 0.56, 0.52],
       [0.44, 0.32, 0.2 , 0.32, 0.44, 0.56, 0.68, 0.8 , 0.68, 0.56],
       [0.4 , 0.2 , 0.  , 0.2 , 0.4 , 0.6 , 0.8 , 1.  , 0.8 , 0.6 ],
       [0.44, 0.32, 0.2 , 0.32, 0.44, 0.56, 0.68, 0.8 , 0.68, 0.56],
       [0.48, 0.44, 0.4 , 0.44, 0.48, 0.52, 0.56, 0.6 , 0.56, 0.52]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the image attributes.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (10, 10)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the image.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f59de3b41a018accdd230c34e8570ba26c4b3afb325ab5afa567d3a9a52de9b5.png" src="_images/f59de3b41a018accdd230c34e8570ba26c4b3afb325ab5afa567d3a9a52de9b5.png" />
</div>
</div>
<p>Well, that is certainly more artistic than the original!</p>
<p>We now have many more <code class="docutils literal notranslate"><span class="pre">unique</span></code> values in the output array than there were in the input array (the input array contained only 0’s and 1’s), because <code class="docutils literal notranslate"><span class="pre">skimage</span></code> is <em>interpolating</em> for many new pixels.  <em>Interpolation</em> is the process of estimating values for the new pixels which fall in between the array pixels from the original array image, based on the weighted average of the values of the original pixels to which they are nearest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the `unique` values.</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.2 , 0.2 , 0.2 , 0.32, 0.32, 0.32, 0.32, 0.4 , 0.4 , 0.4 ,
       0.44, 0.44, 0.48, 0.48, 0.52, 0.52, 0.56, 0.56, 0.56, 0.6 , 0.6 ,
       0.6 , 0.68, 0.68, 0.68, 0.68, 0.8 , 0.8 , 0.8 , 1.  ])
</pre></div>
</div>
</div>
</div>
<p>The array pixels highlighted in red are the original pixels from the <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>
original array:</p>
<p><img alt="" src="_images/resize_interpolation.png" /></p>
<p>All the other pixels have been added by <code class="docutils literal notranslate"><span class="pre">skimage</span></code> during the <code class="docutils literal notranslate"><span class="pre">resize</span></code>-ing process. Pixels closer to the original pixels share closer intensity values to the original pixel (meaning they are more black or more white, depending on the original pixel). Images further from the original pixels become more gray.</p>
<p>We can control the type of interpolation that <code class="docutils literal notranslate"><span class="pre">skimage</span></code> uses by changing the
(somewhat cryptically named) <code class="docutils literal notranslate"><span class="pre">order</span></code> argument. Setting <code class="docutils literal notranslate"><span class="pre">order=0</span></code> will activate
<a class="reference external" href="https://en.wikipedia.org/wiki/Nearest-neighbor_interpolation">nearest neighbor
interpolation</a>.
This method of interpolation (estimation) merely uses the nearest existing
pixel to give the value for any new pixel in the output image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass our `squares` array to the `ski.transform.resize()` function.</span>
<span class="n">squares_ten_by_ten</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">squares</span><span class="p">,</span>
                                          <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                          <span class="n">preserve_range</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Nearest neighbor</span>

<span class="c1"># Show the resized array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">squares_ten_by_ten</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b5c2bb53083ac8e767a9af251102588858fc42ed2ba1975298e2d2439d264a17.png" src="_images/b5c2bb53083ac8e767a9af251102588858fc42ed2ba1975298e2d2439d264a17.png" />
</div>
</div>
<p>This seems much closer to what we want when we <code class="docutils literal notranslate"><span class="pre">resize</span></code> the image. However, the results of image processing are highly context-dependent, and there may be images for which the default interpolation setting works better…</p>
</section>
<section id="rotation">
<h2>Rotation<a class="headerlink" href="#rotation" title="Link to this heading">#</a></h2>
<p>Another common image manipulation we may want to do is to rotate an image.</p>
<section id="rotations-in-90-degree-increments">
<h3>Rotations in 90 degree increments<a class="headerlink" href="#rotations-in-90-degree-increments" title="Link to this heading">#</a></h3>
<p>Should we only want to rotate by increments of 90 degrees, we can use the
helpfully named <code class="docutils literal notranslate"><span class="pre">np.rot90()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the image.</span>
<span class="n">rotated_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">rotated_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 1., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.],
       [0., 1., 1., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19d9b78b04a9a44c84a6d7e2cc6901ec92132457f2ad81f200fc24d78199fe8e.png" src="_images/19d9b78b04a9a44c84a6d7e2cc6901ec92132457f2ad81f200fc24d78199fe8e.png" />
</div>
</div>
<p>We can control the number of rotations with the <code class="docutils literal notranslate"><span class="pre">k</span></code> argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the image, twice!</span>
<span class="n">rotated_i_180</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                         <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Two 90 degree rotations.</span>
<span class="n">rotated_i_180</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_180</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/209add903c33efd7aa20bfa370c7f14595adb25270945d89cd43948cd77a2740.png" src="_images/209add903c33efd7aa20bfa370c7f14595adb25270945d89cd43948cd77a2740.png" />
</div>
</div>
<p>Rotating in increments of 90 degrees will not change the <em>size</em> (e.g. number of pixels) in the array, however it will change the integer index location of the pixel values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the shape of the original image and both 90 degree rotated images.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">i_img</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">rotated_i</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`.shape` = </span><span class="si">{</span><span class="n">rotated_i_180</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_180</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3f6d04921436781726746514f2f9d0a7a3db36776e9838e361b2e2a85ae68f8c.png" src="_images/3f6d04921436781726746514f2f9d0a7a3db36776e9838e361b2e2a85ae68f8c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original image and 90 degree rotations all have the same number of elements (15*8 = 120)</span>
<span class="n">i_img</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">rotated_i</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">rotated_i_180</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="rotations-by-arbitrary-angles-with-scipy">
<h3>Rotations by arbitrary angles with Scipy<a class="headerlink" href="#rotations-by-arbitrary-angles-with-scipy" title="Link to this heading">#</a></h3>
<p>To rotate an image by more flexible increments than 90 degrees, we need to
bring in SciPy, another foundation library for Scikit-image. The SciPy
function <code class="docutils literal notranslate"><span class="pre">ndimage.rotate()</span></code> offers more flexible rotation. However, rotating
by other angles will alter both the <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> of the output image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import SciPy using the conventional name (`sp`).</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="c1"># Rotate the image by 193 degrees.</span>
<span class="n">rotated_i_193</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                                  <span class="n">angle</span><span class="o">=</span><span class="mi">193</span><span class="p">)</span> <span class="c1"># Specify the rotation angle.</span>

<span class="c1"># Show the &quot;raw&quot; array.</span>
<span class="n">rotated_i_193</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,
         0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  9.19e-02,  3.28e-01,  1.46e-02,
        -9.30e-03,  1.14e-03,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  1.19e-02, -7.40e-02,  8.85e-01,  1.30e+00,  2.34e-01,
        -5.79e-02,  9.74e-03,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  2.30e-02, -9.94e-02,  5.32e-01,  1.16e+00,  4.46e-01,
        -9.18e-02,  1.97e-02,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  1.33e-02, -7.05e-02,  2.94e-01,  1.18e+00,  7.22e-01,
        -9.12e-02,  2.01e-02,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  3.35e-03, -2.49e-02,  7.87e-02,  1.06e+00,  9.45e-01,
        -2.01e-02,  1.59e-03,  3.04e-05,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  1.05e-02, -5.31e-02,  8.77e-01,  1.11e+00,
         1.43e-01, -4.04e-02,  6.37e-03,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  2.16e-02, -9.77e-02,  6.31e-01,  1.19e+00,
         3.73e-01, -8.34e-02,  1.70e-02,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  1.69e-02, -8.35e-02,  3.76e-01,  1.20e+00,
         6.38e-01, -9.80e-02,  2.14e-02,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  6.43e-03, -4.04e-02,  1.40e-01,  1.07e+00,
         8.46e-01, -5.22e-02,  1.08e-02,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  2.94e-05,  1.59e-03, -2.13e-02,  1.05e+00,
         1.21e+00,  8.46e-02, -2.23e-02,  2.08e-03,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  2.07e-02, -7.40e-02,  3.77e-01,
         2.86e-01,  1.34e-02, -6.91e-04,  2.08e-03,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  2.41e-04, -3.74e-03,  1.05e-01,
         6.11e-01,  4.42e-01, -1.04e-01,  2.57e-02,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  8.91e-03, -6.26e-02,  2.63e-01,
         1.43e+00,  9.24e-01, -7.36e-02,  1.14e-02,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  1.17e-03, -9.12e-03,  1.40e-02,
         3.06e-01,  8.45e-02,  0.00e+00,  0.00e+00,  0.00e+00],
       [ 0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,
         0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00,  0.00e+00]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Render the image graphically.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_i_193</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de3e5f8637aec11dcc177d81ca1ecc1b4807d581f026f3f9e4c0f9755df82e98.png" src="_images/de3e5f8637aec11dcc177d81ca1ecc1b4807d581f026f3f9e4c0f9755df82e98.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the attributes of the rotated image.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">rotated_i_193</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (16, 11)
Max Pixel Value: 1.43
Min Pixel Value: -0.1
</pre></div>
</div>
</div>
</div>
<p>The cell below will loop through some different rotation angles, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of each image is shown below each plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A for loop to show multiple rotations, and the effect on</span>
<span class="c1"># the shape of the resultant image array.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span> 
                                    <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_rot</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fdfa5c78f0619ed0b28ffc66329546631ca2c93d82615786d078be9b4a1207c9.png" src="_images/fdfa5c78f0619ed0b28ffc66329546631ca2c93d82615786d078be9b4a1207c9.png" />
</div>
</div>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> is altered so that the rotated original array is shown
within the output array. SciPy uses interpolation to estimate the values of
the pixels it adds, where the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of the output image is larger than the
<code class="docutils literal notranslate"><span class="pre">shape</span></code> of the input image.</p>
<p>We can disable this behaviour by settings <code class="docutils literal notranslate"><span class="pre">reshape=False</span></code>, however, this means that we will clip any parts of the array that have been rotated out of the field of view of the original array shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A for loop to show multiple rotations, and the effect on</span>
<span class="c1"># the shape of the resultant image array, but this time</span>
<span class="c1"># we do not allow SciPy to reshape the output arrays.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">i_img</span><span class="p">,</span>
                                    <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">,</span>
                                    <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Don&#39;t reshape output.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_rot</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2db327cff9c8b44a106d8cd0da85c14dc3ff00d94738258441ca8639ce19bf3.png" src="_images/c2db327cff9c8b44a106d8cd0da85c14dc3ff00d94738258441ca8639ce19bf3.png" />
</div>
</div>
</section>
</section>
<section id="rotating-with-skimage">
<h2>Rotating with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#rotating-with-skimage" title="Link to this heading">#</a></h2>
<p>Let’s now look now at how rotating image arrays is handled in <code class="docutils literal notranslate"><span class="pre">skimage</span></code>. Image rotation, which we saw above using <code class="docutils literal notranslate"><span class="pre">np.rot90</span></code> and <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.rotate()</span></code> can be achieved using the straightforwardly named <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>, and the syntax works identically to <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.rotate()</span></code>. All this rotating has left us thirsty and caffeine-deprived, so let’s get some <code class="docutils literal notranslate"><span class="pre">coffee</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import and show an image.</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/97fe6e20ae416a866bb7ec14a2e5b284f2a37fea6a05fbac65c3646d0ddd8270.png" src="_images/97fe6e20ae416a866bb7ec14a2e5b284f2a37fea6a05fbac65c3646d0ddd8270.png" />
</div>
</div>
<p>We can achieve easy and flexible rotation with <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate the `coffee` image with `skimage`.</span>
<span class="c1"># resize=True ensures all the original image fits inside the output.</span>
<span class="n">rotated_coffee</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span>
                                      <span class="n">angle</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                                      <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_coffee</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/909af6b8f1420db6e08295f4a0d49fe47fc56fc2ac257555339ed188f7ae74e0.png" src="_images/909af6b8f1420db6e08295f4a0d49fe47fc56fc2ac257555339ed188f7ae74e0.png" />
</div>
</div>
<p>The cell below plots a variety of rotations, using <code class="docutils literal notranslate"><span class="pre">skimage.transform.rotate()</span></code> to perform each rotation, this time disabling resize of the output to fit the rotated input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Many rotations...</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">45</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">current_rot</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span>
                                       <span class="n">angle</span><span class="o">=</span><span class="n">i_2</span><span class="p">,</span>
                                       <span class="n">resize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">current_rot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i_2</span><span class="si">}</span><span class="s2">°&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b295c0df6206cd0d1707bb5343ebdcb2fe9c586d1a1bdde8ac30f68bd41fae04.png" src="_images/b295c0df6206cd0d1707bb5343ebdcb2fe9c586d1a1bdde8ac30f68bd41fae04.png" />
</div>
</div>
</section>
<section id="rotation-compared-to-flips-and-transpos">
<h2>Rotation compared to flips and transpos<a class="headerlink" href="#rotation-compared-to-flips-and-transpos" title="Link to this heading">#</a></h2>
<p>Rotating is a different operation that flipping the image with <code class="docutils literal notranslate"><span class="pre">np.flip</span></code>.  Flipping causes a reflection in the image around its center.  The difference between rotation and applying a flip becomes obvious with an image that is not left-right symmetrical.</p>
<p>The cell below demonstrates <code class="docutils literal notranslate"><span class="pre">np.flip</span></code>-ping an image, as well as <code class="docutils literal notranslate"><span class="pre">np.rot</span></code>-ating an image by 180 degrees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in `camera`</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>

<span class="c1"># Rotate, flip &#39;n&#39; plot!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;np.rot90(k=2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">camera</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;np.flip()&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eca27dd0ebcff97883ac79b3f3eeced5d3f9d29f54615c2aa01f60cbafaf501a.png" src="_images/eca27dd0ebcff97883ac79b3f3eeced5d3f9d29f54615c2aa01f60cbafaf501a.png" />
</div>
</div>
<p>Similarly, rotations differ from transpose operations on the array.</p>
<p>Specifically for 90 degree rotations, you might be tempted to use a NumPy shortcut, and use the <code class="docutils literal notranslate"><span class="pre">.T</span></code> (transpose) method. This however, will do something different to rotation. The cell below demonstrates the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method, with the <code class="docutils literal notranslate"><span class="pre">camera</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose `camera`.</span>
<span class="n">camera_transposed</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">T</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;camera.T&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/b37afc8a257d6d001851fc9fdfd890e388f15a70509f111756a988fa5931a358.png" src="_images/b37afc8a257d6d001851fc9fdfd890e388f15a70509f111756a988fa5931a358.png" />
</div>
</div>
<p>We now show a 90 degree rotation, using <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate by 90 degrees.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> 
                                <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ski.transform.rotate()&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c81025159ea6474d497721608e43edf5e4dfa324f0571b40dc573b4a6cdd3b4b.png" src="_images/c81025159ea6474d497721608e43edf5e4dfa324f0571b40dc573b4a6cdd3b4b.png" />
</div>
</div>
<p>We can see that the cameraman is facing a different direction in each image (taking a photo of the bottom of the image for the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method, and taking a photo of the top of the image for a 90 degree rotation via <code class="docutils literal notranslate"><span class="pre">skimage</span></code>).</p>
<p>The difference here is that transposing an image switches the rows and columns, such that the first row becomes the first column etc. Conversely, <code class="docutils literal notranslate"><span class="pre">skimage.transform.rotate()</span></code> pivots the pixels around a central point. Essentially, transposing gives a <em>mirroring effect</em> which is different from a rotation.</p>
<p>Pay attention to the location of the spoon in the <code class="docutils literal notranslate"><span class="pre">coffee</span></code> image. First, we <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code> it by 90 degrees. Then, we show it <code class="docutils literal notranslate"><span class="pre">.transpose</span></code>d, switching the rows and columns. As <code class="docutils literal notranslate"><span class="pre">coffee</span></code> is a 3D image, the <code class="docutils literal notranslate"><span class="pre">.T</span></code> method will produce an error, because the color channels will be moved into the wrong dimension - to avoid this we use the <code class="docutils literal notranslate"><span class="pre">.transpose</span></code> method, to keep the color channels in the third dimension, whilst switching the rows and columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The `shape` of the original `coffee` image.</span>
<span class="n">coffee</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400, 600, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Why we cannot use the `.T` method. We get an array which</span>
<span class="c1"># is the wrong `shape` for a color image!</span>
<span class="n">coffee</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 600, 400)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Move the columns into the rows, the rows into the columns, and leave the</span>
<span class="c1"># color channels in the third dimension.</span>
<span class="n">coffee_transposed</span> <span class="o">=</span> <span class="n">coffee</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">)</span>

<span class="c1"># Show the attributes (not that the `shape` is still correct for a color</span>
<span class="c1"># image).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (600, 400, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/e092896a32985974d8bfe34dddd4251f5a45d69285dddc58178c10b94f948bea.png" src="_images/e092896a32985974d8bfe34dddd4251f5a45d69285dddc58178c10b94f948bea.png" />
</div>
</div>
<p>Compare this to a 90 degree rotation via <code class="docutils literal notranslate"><span class="pre">skimage</span></code>; pay attention to the
spoon!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the difference between rotating and transposing.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">coffee</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ski.transform.rotate()&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_transposed</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;.transpose()&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3f1caf516bedb2502b0d5360fbbac189ca3cb8009774db1a991c2ab8f1c8b592.png" src="_images/3f1caf516bedb2502b0d5360fbbac189ca3cb8009774db1a991c2ab8f1c8b592.png" />
</div>
</div>
<p>Unless you specifically want a mirroring transformation, then use <code class="docutils literal notranslate"><span class="pre">.rotate()</span></code>!</p>
<div class="exercise dropdown admonition" id="look-at-me">

<p class="admonition-title"><span class="caption-number">Exercise 13 </span></p>
<section id="exercise-content">
<p>Your mission now is to transform <code class="docutils literal notranslate"><span class="pre">camera</span></code> into this slightly brain-bending image:</p>
<p><img alt="" src="_images/look_at_me.png" /></p>
<p>For comparison, here is the original <code class="docutils literal notranslate"><span class="pre">camera</span></code> image and its attributes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff8457bed0&gt;
</pre></div>
</div>
<img alt="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" src="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<p>Your final image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 1024)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p><em>Hint</em>: if you did not complete the earlier exercise involving combining two
<code class="docutils literal notranslate"><span class="pre">i_img</span></code> arrays, then you may want to investigate NumPy functions for combining
arrays together to complete the current exercise…</p>
<p><em>Caution:</em> you may run into some errors/odd outcomes because of <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s
here… so use the <code class="docutils literal notranslate"><span class="pre">ski.util</span></code> conversion functions if you need to…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-5">

<p class="admonition-title">Solution to<a class="reference internal" href="#look-at-me"> Exercise 13</a></p>
<section id="solution-content">
<p>Here we need a transpose operation, followed by a rotation, followed by a concatenation.</p>
<p>That is a mouthful, let’s break it down. First we transpose the <code class="docutils literal notranslate"><span class="pre">camera</span></code> array, we can use <code class="docutils literal notranslate"><span class="pre">.T</span></code> here rather than <code class="docutils literal notranslate"><span class="pre">.transpose</span></code> as we are dealing with a 2D grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose `camera`.</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">mirror_camera</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mirror_camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a312af2ed7b8df0254fb872f41b139923a568f305478e438ea3bcf2dd4cd594a.png" src="_images/a312af2ed7b8df0254fb872f41b139923a568f305478e438ea3bcf2dd4cd594a.png" />
</div>
</div>
<p>Now the image is transposed, we have achieved our “mirror” effect. To get this mirrored cameraman to look the other guy in the eye, we now need to rotate the image 270 degrees, for which we use <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate and show.</span>
<span class="n">rotated_mirror_camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">mirror_camera</span><span class="p">,</span>
                                             <span class="n">angle</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span>
                                             <span class="n">resize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Preserve shape.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2ab979f7a4113c3bbdf5667a0609830c8e63ab4173326bd53040963c70f48477.png" src="_images/2ab979f7a4113c3bbdf5667a0609830c8e63ab4173326bd53040963c70f48477.png" />
</div>
</div>
<p>Now, we must combine the images, using <code class="docutils literal notranslate"><span class="pre">np.concat()</span></code>, combining along the columns (<code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>). First, however, we need to ensure the <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s match! If we don’t we get an unexpected result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the images, non-matching `dtype`s...</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">camera</span><span class="p">,</span> <span class="n">rotated_mirror_camera</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">look_at_me</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cebd976eee86ca6c8ce8e6934ec15ffbef529cad220047e876a92c88967cb578.png" src="_images/cebd976eee86ca6c8ce8e6934ec15ffbef529cad220047e876a92c88967cb578.png" />
</div>
</div>
<p>Oops. This has occurred because <code class="docutils literal notranslate"><span class="pre">ski.transform.rotate()</span></code> has converted the image to the <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype, whereas the original is <code class="docutils literal notranslate"><span class="pre">uint8</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The attributes of the original image (look at the `dtype`).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The attributes of the rotated mirror image (look at the `dtype`).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (512, 512)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">ski.util.img_as_ubyte()</span></code> will ensure that the pixel values match, giving us our final, surreal result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure matching `dtype`s.</span>
<span class="n">rotated_mirror_camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">rotated_mirror_camera</span><span class="p">)</span>

<span class="c1"># Combine the images and show the result.</span>
<span class="n">look_at_me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">camera</span><span class="p">,</span> <span class="n">rotated_mirror_camera</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">look_at_me</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9e24e2a902819adf6f68ee36efb7d589a3dd9612d87549c17ba336017d693fa6.png" src="_images/9e24e2a902819adf6f68ee36efb7d589a3dd9612d87549c17ba336017d693fa6.png" />
</div>
</div>
<p>If in doubt, check the <code class="docutils literal notranslate"><span class="pre">dtype</span></code>!</p>
</section>
</div>
<div class="exercise dropdown admonition" id="yellow-fellow">

<p class="admonition-title"><span class="caption-number">Exercise 14 </span></p>
<section id="exercise-content">
<p>For this exercise, you should load in the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image from <code class="docutils literal notranslate"><span class="pre">ski.data</span></code>. Here is the original <code class="docutils literal notranslate"><span class="pre">cat</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff8439f610&gt;
</pre></div>
</div>
<img alt="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" src="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" />
</div>
</div>
<p>The original image has the following attributes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<p>Now, using only <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">skimage</span></code>, try to recreate this target image:</p>
<p><img alt="" src="_images/poor_cat.png" /></p>
<p>…poor cat!</p>
<p>Your output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.76
Min Pixel Value: 0.0
</pre></div>
</div>
<p><em>Hint</em>: Note the yellow tinge to the image.  You can achieve this tinge by modifying the weights of the colors in the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-7">

<p class="admonition-title">Solution to<a class="reference internal" href="#yellow-fellow"> Exercise 14</a></p>
<section id="solution-content">
<p>The solution here again involves multiple steps. First we load in the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in and show the `cat` image.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" src="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" />
</div>
</div>
<p>Next, to replicate the yellow-y tone of the target image, we “switch off” the blue color channel (because red + green = yellow):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make it yellow!</span>
<span class="n">cat_solution</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08e8e5dd7c0f42b2197dd3c364efb4f5c7bfef36fc7dd37628114738eeb39988.png" src="_images/08e8e5dd7c0f42b2197dd3c364efb4f5c7bfef36fc7dd37628114738eeb39988.png" />
</div>
</div>
<p>The target image has the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> (30, 30, 3); the original image has the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> (300, 451, 3).</p>
<p>To get the correct output image size, we must <em>downscale</em> the image. To do this, we can use <code class="docutils literal notranslate"><span class="pre">ski.transform.resize()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Downscale the image.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">,</span>
                                    <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1"># Show the result.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.8
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/0c810295b59256c67247892171b3accec01450632a09ae8127ffa82cdb398a3b.png" src="_images/0c810295b59256c67247892171b3accec01450632a09ae8127ffa82cdb398a3b.png" />
</div>
</div>
<p>You’ll notice that downsizing the image has seriously downgraded the quality. This makes sense, because the original high-resolution image utilized its many pixels to depict intricate details. After resizing to a lower-resolution, this detail is lost, because now we are trying to show the same image using substantially fewer pixels. <code class="docutils literal notranslate"><span class="pre">skimage</span></code> has done some averaging behind the scenes, to work out what should go in the remaining pixels. At least we can still see the image is of a cat…</p>
<p>Now, we can see that the target image requires a rotation, through good judgment, or just trial and error, we can work out that this needs to be 45 degrees. We can also see that the image of the downscaled cat does not “fit” inside the final image. As such, we need to rotate <em>without resizing</em> the image. By default, <code class="docutils literal notranslate"><span class="pre">resize=False</span></code> so we can leave it on the default setting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rotate and show the result.</span>
<span class="n">cat_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">,</span>
                                    <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (30, 30, 3)
Max Pixel Value: 0.76
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/d736118e2b0467a26d5167a0c8eb1d58c57c60beb92e3ab5ccdbf70ec1dd90fd.png" src="_images/d736118e2b0467a26d5167a0c8eb1d58c57c60beb92e3ab5ccdbf70ec1dd90fd.png" />
</div>
</div>
<p>We will leave it to you to use this image as a logo for your “Pixel Cat” <a class="reference external" href="https://en.wikipedia.org/wiki/Meme_coin">meme coin</a>.</p>
</section>
</div>
</section>
<section id="cropping">
<h2>Cropping<a class="headerlink" href="#cropping" title="Link to this heading">#</a></h2>
<p>The process of <em>cropping</em> is the removal of areas of pixels from an image.</p>
<p>Because our images are just NumPy arrays, cropping is just NumPy indexing
(duh!). As such, we can crop images just with indexing operations, without
using specific NumPy (or <code class="docutils literal notranslate"><span class="pre">skimage</span></code>) functions.</p>
<p>For instance, we can “shave” our <code class="docutils literal notranslate"><span class="pre">i_img</span></code> array in half, along the columns by slicing along the columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cut in half.</span>
<span class="n">half_i</span> <span class="o">=</span> <span class="n">i_img</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">half_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [0., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       [0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">half_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d49cf5fc6278b914715513a6ba4e3407bb4b73221ae93baf52d055534f43b0e1.png" src="_images/d49cf5fc6278b914715513a6ba4e3407bb4b73221ae93baf52d055534f43b0e1.png" />
</div>
</div>
<p>Likewise along the rows (albeit the number of rows is odd!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="p">:]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/53e4ef5e55ffd250477e11cfac8c56455e60026b5dd8764ec05cf70ca3103380.png" src="_images/53e4ef5e55ffd250477e11cfac8c56455e60026b5dd8764ec05cf70ca3103380.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="cropped-camera">

<p class="admonition-title"><span class="caption-number">Exercise 15 </span></p>
<section id="exercise-content">
<p>Take the original <code class="docutils literal notranslate"><span class="pre">camera</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff9a0aaad0&gt;
</pre></div>
</div>
<img alt="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" src="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" />
</div>
</div>
<p>…and crop it down to this target image, using only NumPy indexing:</p>
<p><img alt="" src="_images/camera_cropped.png" /></p>
<p>These are the attributes that your final image should possess:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (30, 80)
Max Pixel Value: 250
Min Pixel Value: 23
</pre></div>
</div>
<p><em>Hint:</em> using <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code> might be of use in identifying the part of the
image you need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">camera_crop_exercise</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" src="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" />
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-9">

<p class="admonition-title">Solution to<a class="reference internal" href="#cropped-camera"> Exercise 15</a></p>
<section id="solution-content">
<p>This is a simple task once you know what indices you need. Using <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code> can make this information easier to obtain:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show `camera`, with a helpful grid.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24d8a74b83195f651da0c97b76a0e53f3df346ca709308f6365c3dc858d2f0b5.png" src="_images/24d8a74b83195f651da0c97b76a0e53f3df346ca709308f6365c3dc858d2f0b5.png" />
</div>
</div>
<p>The exact indices we used are here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">[</span><span class="mi">130</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span><span class="mi">320</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a1b9f3b223b1ddea3392ea77c0e7d61f519ec7c253d44e2a45a03e5c26e17a9.png" src="_images/8a1b9f3b223b1ddea3392ea77c0e7d61f519ec7c253d44e2a45a03e5c26e17a9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution (attributes).</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">camera</span><span class="p">[</span><span class="mi">130</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="mi">240</span><span class="p">:</span><span class="mi">320</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (30, 80)
Max Pixel Value: 250
Min Pixel Value: 23
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
<section id="masks">
<span id="on-masks"></span><h2>Masks<a class="headerlink" href="#masks" title="Link to this heading">#</a></h2>
<p>In image processing, a mask is an array where the elements express weights or binary (0 or 1) values to select areas in another image (array).</p>
<p>A mask is “placed” on an image, and one typically then applies operations to
the pixels indicated by the mask.  For example, one might use the mask with an
image array to replace pixels indicated by the mask with a specific value.
Let’s demonstrate with a real image — a grayscale version of the standard
<code class="docutils literal notranslate"><span class="pre">coffee</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make coffee RGB image into single-channel image.</span>
<span class="n">coffee_gray</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coffee</span><span class="p">())</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">coffee_gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coffee_gray</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (400, 600)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/d82d52811692c04712ff3dd4c3535ca3c131a987f9aaed636b100e92840c3bfd.png" src="_images/d82d52811692c04712ff3dd4c3535ca3c131a987f9aaed636b100e92840c3bfd.png" />
</div>
</div>
<p>In this case we are going to create a new mask image, that corresponds to the
<code class="docutils literal notranslate"><span class="pre">coffee_gray</span></code> image (has the same shape), but where we will create the mask
values with a mathematical formula using the row and column indices.  In fact
we’ll do this to create a circular mask.  Bear with us, all should be come
clear as we go.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unpack and store the number of rows and number of columns.</span>
<span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span> <span class="o">=</span> <span class="n">coffee_gray</span><span class="o">.</span><span class="n">shape</span>
<span class="n">dim_0</span><span class="p">,</span> <span class="n">dim_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400, 600)
</pre></div>
</div>
</div>
</div>
<p>We are going to create a circular mask, using the formula for a circle.</p>
<p>That formula needs the <code class="docutils literal notranslate"><span class="pre">i</span></code> (row) and <code class="docutils literal notranslate"><span class="pre">j</span></code> coordinates for each pixel, the center coordinate of the circle, and the radius <code class="docutils literal notranslate"><span class="pre">r</span></code> of the desired circle.</p>
<p>Call the row and column center coordinates <span class="math notranslate nohighlight">\(c_i, c_j\)</span> respectively.</p>
<p>We can tell if a particular pixel at (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>) is <em>outside</em> the circle by testing whether the Euclidean distance of the pixel position (<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>) from the center is greater than <span class="math notranslate nohighlight">\(r\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\sqrt{(i - c_i)^2 + (j - c_j)^2} &gt; r
\]</div>
<p>First we use the Numpy <code class="docutils literal notranslate"><span class="pre">meshgrid</span></code> function to return two arrays, one containing all the <code class="docutils literal notranslate"><span class="pre">i</span></code> (row) coordinates at each pixel, and another containing all the <code class="docutils literal notranslate"><span class="pre">j</span></code> (column) coordinates at each pixel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># indexing=&#39;ij&#39; tells meshgrid to return `i` and `j` coordinates.  There are other modes, not relevant here.</span>
<span class="n">i_coords</span><span class="p">,</span> <span class="n">j_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dim_0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dim_1</span><span class="p">),</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
<span class="c1"># i coordinate for each element.</span>
<span class="n">i_coords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  0,   0,   0, ...,   0,   0,   0],
       [  1,   1,   1, ...,   1,   1,   1],
       [  2,   2,   2, ...,   2,   2,   2],
       ...,
       [397, 397, 397, ..., 397, 397, 397],
       [398, 398, 398, ..., 398, 398, 398],
       [399, 399, 399, ..., 399, 399, 399]], shape=(400, 600))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># j coordinate for each element.</span>
<span class="n">j_coords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  0,   1,   2, ..., 597, 598, 599],
       [  0,   1,   2, ..., 597, 598, 599],
       [  0,   1,   2, ..., 597, 598, 599],
       ...,
       [  0,   1,   2, ..., 597, 598, 599],
       [  0,   1,   2, ..., 597, 598, 599],
       [  0,   1,   2, ..., 597, 598, 599]], shape=(400, 600))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The coordinate of the image center in pixels.  Remember that pixel indices</span>
<span class="c1"># start at 0.</span>
<span class="n">c_i</span><span class="p">,</span> <span class="n">c_j</span> <span class="o">=</span> <span class="p">(</span><span class="n">dim_0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">dim_1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="c1"># Radius</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">275</span>
</pre></div>
</div>
</div>
</div>
<p>We can then use the formula above to generate a 2D array where True (== 1) means outside the circle and False (== 0) means inside the circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a circular mask.</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">i_coords</span> <span class="o">-</span> <span class="n">c_i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">j_coords</span> <span class="o">-</span> <span class="n">c_j</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: bool
Shape: (400, 600)
Max Pixel Value: True
Min Pixel Value: False
</pre></div>
</div>
<img alt="_images/c4a9148ba2313342c28dca009ce893a938f0fc0681e4ef2e74a754e3d1f87436.png" src="_images/c4a9148ba2313342c28dca009ce893a938f0fc0681e4ef2e74a754e3d1f87436.png" />
</div>
</div>
<p>Once we have our mask - which is just a Boolean array - it is just a matter of Boolean indexing to set all the pixel values in the image to the same value, where there is a True in the corresponding element in the mask:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the mask.</span>
<span class="n">coffee_gray_masked</span> <span class="o">=</span> <span class="n">coffee_gray</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">coffee_gray_masked</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">coffee_gray_masked</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/30aecc7b34cc5409048f2e563d4e56f26945cc833cd94251a78d05a77fa6e915.png" src="_images/30aecc7b34cc5409048f2e563d4e56f26945cc833cd94251a78d05a77fa6e915.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="masked-man">

<p class="admonition-title"><span class="caption-number">Exercise 16 </span></p>
<section id="exercise-content">
<p>Start with the <code class="docutils literal notranslate"><span class="pre">camera</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">camera</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" src="_images/35f9dfe13bfb22923a0ffb4e30a0a71877c6b8ffb9cf0556ebe377899835cbf3.png" />
</div>
</div>
<p>Now consider this formula, where <span class="math notranslate nohighlight">\(p\)</span> is some constant:</p>
<div class="math notranslate nohighlight">
\[
((i - c_i)^3 + (j - c_j)^3)^{1/3} &gt; p
\]</div>
<p>(where <span class="math notranslate nohighlight">\(x^{1/3}\)</span> is the cube-root of <span class="math notranslate nohighlight">\(x\)</span>).</p>
<p>Use that formula, with some suitable value for <code class="docutils literal notranslate"><span class="pre">p</span></code>, and masking as above, to create the following image:</p>
<p><img alt="" src="_images/masked_camera.png" /></p>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-11">

<p class="admonition-title">Solution to<a class="reference internal" href="#masked-man"> Exercise 16</a></p>
<section id="solution-content">
<p>We apply the formula above to the <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> coordinates of the <code class="docutils literal notranslate"><span class="pre">camera</span></code>
image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 1.</span>
<span class="n">cam_c_i</span><span class="p">,</span> <span class="n">cam_c_j</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">camera</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">55</span>  <span class="c1"># By experiment.</span>
<span class="n">i_cam</span><span class="p">,</span> <span class="n">j_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">camera</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">camera</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                           <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
<span class="c1"># Apply formula to make mask.</span>
<span class="n">mask_camera</span> <span class="o">=</span> <span class="p">((</span><span class="n">i_cam</span> <span class="o">-</span> <span class="n">cam_c_i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">j_cam</span> <span class="o">-</span> <span class="n">cam_c_j</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">p</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_camera</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2664/2746963989.py:8: RuntimeWarning: invalid value encountered in power
  mask_camera = ((i_cam - cam_c_i) ** 3 + (j_cam - cam_c_j) ** 3) ** (1 / 3) &gt; p
</pre></div>
</div>
<img alt="_images/123c665ff25db3b701165b4ffb58e9f44a742dbaa44d265ba5b49357045e5f3c.png" src="_images/123c665ff25db3b701165b4ffb58e9f44a742dbaa44d265ba5b49357045e5f3c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 2.</span>
<span class="n">camera_masked_solution</span> <span class="o">=</span> <span class="n">camera</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">camera_masked_solution</span><span class="p">[</span><span class="n">mask_camera</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera_masked_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d9c0f0d9fb1e93ccdd88566f8cbed377629ded1ef6b06cde3d6939945b5be4c3.png" src="_images/d9c0f0d9fb1e93ccdd88566f8cbed377629ded1ef6b06cde3d6939945b5be4c3.png" />
</div>
</div>
</section>
</div>
</section>
<section id="inverting-image-colors-with-numpy">
<h2>Inverting image colors with Numpy<a class="headerlink" href="#inverting-image-colors-with-numpy" title="Link to this heading">#</a></h2>
<p>We saw <em>color inversion</em> on an <a class="reference internal" href="0_images_as_numpy_arrays.html"><span class="doc std std-doc">earlier page</span></a>. This is where all the pixel values in an image are, shockingly, inverted: high numbers become low numbers and vice versa:</p>
<p>For a binary image, this involves swapping 1s and 0s…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original image</span>
<span class="n">i_img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 1., 1., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">i_img</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" src="_images/e2d5f31f4442465d729851f9024f8732311e3e3be101d081d87bc275a38d9edb.png" />
</div>
</div>
<p>…which can be accomplished with some simple numeric operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inverted_i</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i_img</span>
<span class="n">inverted_i</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 1., 1., 1., 1., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 0., 0., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_i</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2d8e811c0a14ecbc1fab91f7354a8bc4fd87a807f43c8dc62f8372118b4eb837.png" src="_images/2d8e811c0a14ecbc1fab91f7354a8bc4fd87a807f43c8dc62f8372118b4eb837.png" />
</div>
</div>
<p>What about a color image?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colorwheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">()</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/a45f666e5776e35adfcfa813430b2f2d3006553ddc5420ec486e87d226653365.png" src="_images/a45f666e5776e35adfcfa813430b2f2d3006553ddc5420ec486e87d226653365.png" />
</div>
</div>
<p>Because the maximum value is now 255, we can subtract each array pixel value
in each color channel from 255 to “reverse” the values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Invert the color image, manually.</span>
<span class="n">inverted_colorwheel</span> <span class="o">=</span> <span class="n">colorwheel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">inverted_colorwheel</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">-</span> <span class="n">inverted_colorwheel</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_colorwheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23537d3a744b91511a23625f2f053c610e2d91c008f648dc04efa41f8920764f.png" src="_images/23537d3a744b91511a23625f2f053c610e2d91c008f648dc04efa41f8920764f.png" />
</div>
</div>
</section>
<section id="inverting-colors-with-skimage">
<h2>Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#inverting-colors-with-skimage" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> handles color inversion, we simply pass it a color NumPy image array and <em>voilà!</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Invert the color image, with `skimage`.</span>
<span class="n">invert_colorwheel_with_skimage</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">invert_colorwheel_with_skimage</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23537d3a744b91511a23625f2f053c610e2d91c008f648dc04efa41f8920764f.png" src="_images/23537d3a744b91511a23625f2f053c610e2d91c008f648dc04efa41f8920764f.png" />
</div>
</div>
<div class="exercise dropdown admonition" id="inv-brick">

<p class="admonition-title"><span class="caption-number">Exercise 17 </span></p>
<section id="exercise-content">
<p>Now over to you. You will be working on the <code class="docutils literal notranslate"><span class="pre">brick</span></code> image from <code class="docutils literal notranslate"><span class="pre">ski.data</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brick</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">brick</span><span class="p">()</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">brick</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">brick</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 63
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff89666350&gt;
</pre></div>
</div>
<img alt="_images/0517c8f9ad13e398cd75c28dd662d822fea0b72500e97428433c29c274fc04bc.png" src="_images/0517c8f9ad13e398cd75c28dd662d822fea0b72500e97428433c29c274fc04bc.png" />
</div>
</div>
<p>You should then invert every 2nd element on even numbered rows…</p>
<p>So on <em>even</em> numbered rows (row 0, 2, 4, 6, etc.), if you went through the elements in pairs along the row, the <em>second</em> element in each pair should be inverted, vs the original image.</p>
<p>Your final image should look like this:</p>
<p><img alt="" src="_images/inverted_bricks.png" /></p>
<p>Your new image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 48 
</pre></div>
</div>
<p>Use only NumPy indexing and Scikit-image functions to do this…</p>
<p><em>Hint:</em> remember that smaller NumPy arrays indexed out of larger NumPy arrays
are still NumPy arrays, and so can be passed as arguments to most <code class="docutils literal notranslate"><span class="pre">skimage</span></code>
functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-13">

<p class="admonition-title">Solution to<a class="reference internal" href="#inv-brick"> Exercise 17</a></p>
<section id="solution-content">
<p>The solution here is just to use slicing to select the elements we need, and
<code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> just these elements, using array indexing.</p>
<p>To get every 2nd element on even numbered rows, we can use <code class="docutils literal notranslate"><span class="pre">brick[0::2,</span> <span class="pre">1::2]</span></code>.</p>
<p>This is easier to appreciate in a smaller array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">small_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get every second element, on even numbered rows.</span>
<span class="n">small_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">small_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 1., 0., 1., 0., 1.],
       [0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the small array (0 elements are now gray).</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">small_arr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2697ea749e42f87a627f12547ca7809059e02614df4c19e74e11a47d301d4b15.png" src="_images/2697ea749e42f87a627f12547ca7809059e02614df4c19e74e11a47d301d4b15.png" />
</div>
</div>
<p>We can invert just the pixel values at these locations, by passing the slices to <code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">brick_solution</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">brick</span><span class="p">()</span>

<span class="n">brick_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

<span class="n">show_attributes</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">brick_solution</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (512, 512)
Max Pixel Value: 207
Min Pixel Value: 48
</pre></div>
</div>
<img alt="_images/33fe090b66fabdc9777fcd49837fc431410d9aff9128553784b6b65877a93e5f.png" src="_images/33fe090b66fabdc9777fcd49837fc431410d9aff9128553784b6b65877a93e5f.png" />
</div>
</div>
</section>
</div>
<div class="exercise dropdown admonition" id="inverted-purple">

<p class="admonition-title"><span class="caption-number">Exercise 18 </span></p>
<section id="exercise-content">
<p>Again using the <code class="docutils literal notranslate"><span class="pre">cat</span></code> image, try to recreate the following target image, using only <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">skimage</span></code>:</p>
<p><img alt="" src="_images/purple_inverted_cat.png" /></p>
<p>Your output image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 255
Min Pixel Value: 24
</pre></div>
</div>
<p>Notice the color change from the standard <code class="docutils literal notranslate"><span class="pre">cat</span></code> image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat</span><span class="p">);</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (300, 451, 3)
Max Pixel Value: 231
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" src="_images/4ee7477b739aa9fda7066966d5336ad7e5db317659e8f8e26fc7d7318b27b680.png" />
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-15">

<p class="admonition-title">Solution to<a class="reference internal" href="#inverted-purple"> Exercise 18</a></p>
<section id="solution-content">
<p>The target image <em>cannot</em> be created using just <code class="docutils literal notranslate"><span class="pre">ski.util.invert()</span></code> on the whole <code class="docutils literal notranslate"><span class="pre">cat</span></code> image array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_solution_2</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cat_solution_2</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e41e84913b0e023c43fb6e289c55a4b52b724a24a38ec5039d5ffa4f43df6f62.png" src="_images/e41e84913b0e023c43fb6e289c55a4b52b724a24a38ec5039d5ffa4f43df6f62.png" />
</div>
</div>
<p>This looks cool - if anything <em>cooler</em> than the target image - but it is not what we want.</p>
<p>To recreate the target image, we must “switch” off the green color channel <em>before</em> we invert the colors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_purple</span> <span class="o">=</span> <span class="n">cat_solution_2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cat_purple</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat_purple</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e62479deb4fbcaff7dd3ed6345766a706e09355e48ba448575e5d5348ba732a8.png" src="_images/e62479deb4fbcaff7dd3ed6345766a706e09355e48ba448575e5d5348ba732a8.png" />
</div>
</div>
<p>Now, when we invert the purple <code class="docutils literal notranslate"><span class="pre">cat</span></code> image, we get the target image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution.</span>
<span class="n">inverted_cat_purple</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cat_purple</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inverted_cat_purple</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff8a11df90&gt;
</pre></div>
</div>
<img alt="_images/f24138b0cdd47cb5338b4891429c156c8631b62e59cf4c9d060c8ff6d5be0a74.png" src="_images/f24138b0cdd47cb5338b4891429c156c8631b62e59cf4c9d060c8ff6d5be0a74.png" />
</div>
</div>
</section>
</div>
</section>
<section id="greyscale-to-binary-conversion">
<h2>Greyscale to binary conversion<a class="headerlink" href="#greyscale-to-binary-conversion" title="Link to this heading">#</a></h2>
<p>Greyscale to binary conversion can be achieved using comparison operators
(<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>). The resulting Boolean array will always be
binary (True or False, 1 or 0).</p>
<p>Let’s demonstrate with a grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a grayscale image.</span>
<span class="c1"># Make a random number generator, with predictable outputs.</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">random_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Replace ones with random integers.</span>
<span class="n">n_checks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">random_check</span><span class="p">)</span>
<span class="n">random_check</span><span class="p">[</span><span class="n">random_check</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="c1"># From 3 through 11.</span>
                                               <span class="n">size</span><span class="o">=</span><span class="n">n_checks</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">random_check</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3443bf1db602944693def16c48eec84dc7e0cb1f18466125b591d329b9ad9204.png" src="_images/3443bf1db602944693def16c48eec84dc7e0cb1f18466125b591d329b9ad9204.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to a binary image:</span>
<span class="n">binary_check</span> <span class="o">=</span> <span class="n">random_check</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">random_check</span><span class="p">)</span>
<span class="n">binary_check</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ True, False,  True, False],
       [False,  True, False,  True],
       [ True, False,  True, False],
       [False,  True, False,  True]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">binary_check</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c1818365f2f5e6dfe7ddae7e6cbbba5c1ce017291453bdc561b981468d1a7324.png" src="_images/c1818365f2f5e6dfe7ddae7e6cbbba5c1ce017291453bdc561b981468d1a7324.png" />
</div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">skimage</span></code> to do this work - see the <a class="reference internal" href="5_mean_filter.html"><span class="doc std std-doc">filtering
page</span></a> for more detail. For now, we can use the
<code class="docutils literal notranslate"><span class="pre">ski.filters.threshold_minimum()</span></code> function. This supplies us a recommended
threshold value to attempt to divide the array pixels into two classes e.g.
two classes where the pixels in each class are maximally different from pixels
in the other class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a recommended threshold from `skimage`.</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">threshold_minimum</span><span class="p">(</span><span class="n">random_check</span><span class="p">)</span>
<span class="n">threshold</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(2)
</pre></div>
</div>
</div>
</div>
<p>We can then use this threshold to create a binary array, successfully
binarizing our grayscale image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Binarize the array, based on the threshold.</span>
<span class="n">binary_check_from_ski</span> <span class="o">=</span> <span class="n">random_check</span> <span class="o">&gt;</span> <span class="n">threshold</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">binary_check_from_ski</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">binary_check_from_ski</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: bool
Shape: (4, 4)
Max Pixel Value: True
Min Pixel Value: False
</pre></div>
</div>
<img alt="_images/c1818365f2f5e6dfe7ddae7e6cbbba5c1ce017291453bdc561b981468d1a7324.png" src="_images/c1818365f2f5e6dfe7ddae7e6cbbba5c1ce017291453bdc561b981468d1a7324.png" />
</div>
</div>
</section>
<section id="color-to-grayscale-conversion-with-numpy">
<h2>Color to grayscale conversion with Numpy<a class="headerlink" href="#color-to-grayscale-conversion-with-numpy" title="Link to this heading">#</a></h2>
<p>To downgrade a color image to grayscale we can use a brute force method of
taking the mean of the three color channels, to produce a 2D monochrome image
array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b48f40f237e716152b1b6ca7866c7e1183b7cb5a4800bbfc1a262e1fffc306f7.png" src="_images/b48f40f237e716152b1b6ca7866c7e1183b7cb5a4800bbfc1a262e1fffc306f7.png" />
</div>
</div>
<p>A better option, that we encountered on the <a class="reference internal" href="2_skimage_intro.html#luminance-formula"><span class="std std-ref">previous
page</span></a>, is to use the <em>luminance formula</em>:</p>
<div class="math notranslate nohighlight">
\[
Y = 0.2126R + 0.7152G + 0.0722B
\]</div>
<p>This collapses a 3D color image into a 2D grayscale image via a weighted sum
of the channels.</p>
<div class="exercise dropdown admonition" id="gray-wheel">

<p class="admonition-title"><span class="caption-number">Exercise 19 </span></p>
<section id="exercise-content">
<p>Here is the original <code class="docutils literal notranslate"><span class="pre">colorwheel</span></code> image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colorwheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7eff89a865d0&gt;
</pre></div>
</div>
<img alt="_images/a45f666e5776e35adfcfa813430b2f2d3006553ddc5420ec486e87d226653365.png" src="_images/a45f666e5776e35adfcfa813430b2f2d3006553ddc5420ec486e87d226653365.png" />
</div>
</div>
<p>It has the following attributes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_attributes</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371, 3)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
</div>
</div>
<p>Using the <a class="reference internal" href="2_skimage_intro.html#luminance-formula"><span class="std std-ref">luminance formula</span></a>, and any other required
<code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code> or <code class="docutils literal notranslate"><span class="pre">skimage</span></code> operations, recreate the target image below,
starting from the <code class="docutils literal notranslate"><span class="pre">colorwheel</span></code> array:</p>
<p><img alt="" src="_images/gray_wheel.png" /></p>
<p>Your final image should have the following attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<p><em>Hint</em>: For Numpy practice, try to use array multiplication <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, or <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code>
or Numpy broadcasting, to apply the luminance formula, rather than slicing.</p>
<p><em>Hint</em>: you may need to rescale the intensity values to match the target image attributes. You may recall there is a <code class="docutils literal notranslate"><span class="pre">ski.exposure</span></code> function which can help you do this…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="solution dropdown admonition" id="3_skimage_processing_from_numpy_and_scipy-solution-17">

<p class="admonition-title">Solution to<a class="reference internal" href="#gray-wheel"> Exercise 19</a></p>
<section id="solution-content">
<p>The solution here requires some close attention to <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. To apply the luminance formula using <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> is pretty straightforward:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution pt 1.</span>

<span class="c1"># Luminance formula coefficients</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2126</span><span class="p">,</span> <span class="mf">0.7152</span><span class="p">,</span> <span class="mf">0.0722</span><span class="p">])</span>

<span class="c1"># Run the numbers...</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">colorwheel</span> <span class="o">@</span> <span class="n">weights</span>

<span class="c1"># Show the result.</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 255.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/cc7da6d230fa7a4390d69d975dd2de27650cebca5350f762a3e579dd885e0098.png" src="_images/cc7da6d230fa7a4390d69d975dd2de27650cebca5350f762a3e579dd885e0098.png" />
</div>
</div>
<p>Notice that the matrix multiplication above left us with float values, as the
weights in the luminance formula are floating point numbers.</p>
<p>But this gives us min/max pixel intensity values which are not standard for
the <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype, and will generate an error when we try to convert to
<code class="docutils literal notranslate"><span class="pre">uint8</span></code> to match the target image:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ouch!</span>
<span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">115</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Ouch!</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/skimage/util/dtype.py:576,</span> in <span class="ni">img_as_ubyte</span><span class="nt">(image, force_copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span> <span class="k">def</span><span class="w"> </span><span class="nf">img_as_ubyte</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">force_copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Convert an image to 8-bit unsigned integer format.</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">558</span><span class="sd">     Parameters</span>
<span class="sd">   (...)    574 </span>
<span class="g g-Whitespace">    </span><span class="mi">575</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">576</span>     <span class="k">return</span> <span class="n">_convert</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">force_copy</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.11/x64/lib/python3.13/site-packages/skimage/util/dtype.py:312,</span> in <span class="ni">_convert</span><span class="nt">(image, dtype, force_copy, uniform)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype_out</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">312</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Images of type float must be between -1 and 1.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span> <span class="c1"># floating point -&gt; integer</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span> <span class="c1"># use float type that can represent output integer type</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span> <span class="n">computation_type</span> <span class="o">=</span> <span class="n">_dtype_itemsize</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>     <span class="n">itemsize_out</span><span class="p">,</span> <span class="n">dtype_in</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span> <span class="p">)</span>

<span class="ne">ValueError</span>: Images of type float must be between -1 and 1.
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ski.exposure.rescale_intensity()</span></code> function can save us again here. First, we make the values standard for a <code class="docutils literal notranslate"><span class="pre">float64</span></code> image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rescale the pixel intensity values into a legal range, for the current `dtype`.</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">rescale_intensity</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">,</span>
                              <span class="n">out_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
</div>
</div>
<p>Now, we can painlessly convert to <code class="docutils literal notranslate"><span class="pre">uint8</span></code>. Finally, to match the target image, we must <code class="docutils literal notranslate"><span class="pre">ski.transform.invert()</span></code> our depressingly dreary colorwheel:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to `uint8` `dtype`.</span>
<span class="n">gray_wheel</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">img_as_ubyte</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>

<span class="c1"># Invert the color and show the result.</span>
<span class="n">gray_wheel</span> <span class="o">=</span>  <span class="n">ski</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_wheel</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: uint8
Shape: (370, 371)
Max Pixel Value: 255
Min Pixel Value: 0
</pre></div>
</div>
<img alt="_images/cb91fc836ffeaec418d3d950b517f3836106992093e43d92d6bd2e78658b0f4d.png" src="_images/cb91fc836ffeaec418d3d950b517f3836106992093e43d92d6bd2e78658b0f4d.png" />
</div>
</div>
</section>
</div>
</section>
<section id="color-to-grayscale-conversion-with-skimage">
<h2>Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code><a class="headerlink" href="#color-to-grayscale-conversion-with-skimage" title="Link to this heading">#</a></h2>
<p>As always, the <code class="docutils literal notranslate"><span class="pre">ski.color</span></code> module has us covered here with the <code class="docutils literal notranslate"><span class="pre">rgb2gray()</span></code> function. We simply pass it the color array that we want to convert to grayscale, without the direct need for the luminance formula:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert color to grayscale.</span>
<span class="n">gray_colorwheel_from_ski</span> <span class="o">=</span> <span class="n">ski</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">colorwheel</span><span class="p">)</span>
<span class="n">show_attributes</span><span class="p">(</span><span class="n">gray_colorwheel_from_ski</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_colorwheel_from_ski</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type: &lt;class &#39;numpy.ndarray&#39;&gt;
dtype: float64
Shape: (370, 371)
Max Pixel Value: 1.0
Min Pixel Value: 0.0
</pre></div>
</div>
<img alt="_images/1e80785bd9b842a80dd933939a9c22ab33656fa8602973c0c9d03912f0b630c8.png" src="_images/1e80785bd9b842a80dd933939a9c22ab33656fa8602973c0c9d03912f0b630c8.png" />
</div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>This page has shown how to implement some fundamental image processing
operations with NumPy, SciPy and Scikit-image. The next page will delve into
<a class="reference internal" href="5_mean_filter.html"><span class="doc std std-doc">image filtering</span></a>.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>Gulati, J. (2024) <em>NumPy for Image Processing</em>. KDnuggets. Available from:
<a class="reference external" href="https://www.kdnuggets.com/numpy-for-image-processing">https://www.kdnuggets.com/numpy-for-image-processing</a></p>
<p>Also see <a class="reference internal" href="1_color_images_as_numpy_arrays.html#color-references"><span class="std std-ref">color images page references</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2_skimage_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introducing Scikit-image</p>
      </div>
    </a>
    <a class="right-next"
       href="4_threshold_filters.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Threshold filtering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-by-repeating">Resizing by repeating</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing-an-image-with-skimage">Resizing an image with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation">Rotation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotations-in-90-degree-increments">Rotations in 90 degree increments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotations-by-arbitrary-angles-with-scipy">Rotations by arbitrary angles with Scipy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-with-skimage">Rotating with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation-compared-to-flips-and-transpos">Rotation compared to flips and transpos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cropping">Cropping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-image-colors-with-numpy">Inverting image colors with Numpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inverting-colors-with-skimage">Inverting colors with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#greyscale-to-binary-conversion">Greyscale to binary conversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-numpy">Color to grayscale conversion with Numpy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#color-to-grayscale-conversion-with-skimage">Color to grayscale conversion with <code class="docutils literal notranslate"><span class="pre">skimage</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Rush, Matthew Brett
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>